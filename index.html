<!DOCTYPE html>
<html lang="ms">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, viewport-fit=cover">
  <title>Jabatan Pengairan dan Saliran Kuala Nerus</title>
  <meta name="description" content="Laman Rasmi Jabatan Pengairan dan Saliran Daerah Kuala Nerus. Info banjir, peta interaktif, data hujan dan aras sungai, serta permohonan rasmi.">
  <meta name="keywords" content="JPS Kuala Nerus, Banjir Terengganu, Peta Interaktif, Data Hujan, OSC, Permohonan Sungai">
  <meta name="author" content="Jabatan Pengairan dan Saliran Daerah Kuala Nerus">
  <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css">
  <link rel="stylesheet" href="https://unpkg.com/leaflet.markercluster/dist/MarkerCluster.css" />
  <link rel="stylesheet" href="https://unpkg.com/leaflet.markercluster/dist/MarkerCluster.Default.css" />
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
  <link rel="stylesheet" href="styles.css">
  <link rel="icon" href="favicon.ico" type="image/x-icon">
<style>
    body {
      margin: 0;
      font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
      background-color: #f9f9f9;
      color: #333;
    }

    header {
      background-color: #005bb5;
      color: white;
      padding: 2rem 1rem 1.2rem 1rem;
      text-align: center;
      box-shadow: 0 2px 8px rgba(0,0,0,0.04);
    }

    .logo-container {
      display: flex;
      justify-content: center;
      align-items: center;
      gap: 2rem;
      margin-bottom: 1rem;
      flex-wrap: wrap;
    }
    .logo-container img {
      max-height: 70px;
      height: 10vw;
      min-height: 48px;
      width: auto;
      object-fit: contain;

      border-radius: 8px;
      padding: 4px 8px;
      box-shadow: 0 2px 8px rgba(0,0,0,0.06);
    }

    .main-title {
      font-size: 2.1rem;
      font-weight: 700;
      letter-spacing: 1px;
      margin: 0;
      color: #fff;
      text-shadow: 0 2px 8px rgba(0,0,0,0.08);
    }

    nav {
      background-color: #0073e6;
      display: flex;
      flex-wrap: wrap;
      justify-content: center;
      padding: 0.8rem 1rem;
      position: sticky;
      top: 0;
      z-index: 999;
      box-shadow: 0 2px 8px rgba(0,0,0,0.04);
    }

    nav a {
      color: white;
      margin: 0 1rem;
      text-decoration: none;
      font-weight: bold;
      font-size: 1.05rem;
      transition: color 0.2s;
      padding: 0.3rem 0.7rem;
      border-radius: 4px;
    }

    nav a:hover, nav a:focus {
      background: #005fa3;
      color: #ffd700;
      outline: none;
    }

    .container {
      margin:0 auto;
      padding: 0 1rem;
      width: 100%;
    }

    section {
      background-color: white;
      padding: 2rem;
      border-radius: 10px;
      box-shadow: 0 4px 12px rgba(0, 0, 0, 0.05);
      margin-bottom: 2rem;
    }
    .section {
      padding-top: 3rem;
      padding-bottom: 3rem;
    }

    h2 {
      color: #004d99;
      margin-top: 0;
    }

    #map {
      height: 500px;
      border-radius: 10px;
      margin-top: 1rem;
      width: 100%;
    }

    .grid {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
      gap: 20px;
      width: 100%;
    }
    #documents ul {
      list-style: none;
      padding-left: 0;
    }
    #documents ul li {
      font-size: 16px;
      margin: 0.5rem 0;
    }
    #documents ul li a {
      color: #0073e6;
      text-decoration: none;
      font-weight: bold;
    }
    #documents ul li a:hover {
      text-decoration: underline;
    }
    #documents ul li::before {
      content: "📥 ";
      margin-right: 6px;
    }

   /* Main Navigation */
    .main-nav {
      background: #0073e6;
      box-shadow: 0 2px 8px rgba(0,0,0,0.04);
      position: sticky;
      top: 0;
      z-index: 999;
    }

    /* Main Menu */
    .nav-menu {
      display: flex;
      position: relative;
      flex-wrap: wrap;
      justify-content: center;
      align-items: center;
      gap: 0.2rem;
      padding: 0;
      margin: 0;
      background: #0073e6;
      list-style: none; /* ✅ Remove black dots */
    }

    .nav-menu > li {
      position: relative;
      list-style: none; /* ✅ Remove black dots */
    }

    .nav-menu > li > a {
      color: white;
      margin: 0 0.5rem;
      text-decoration: none;
      font-weight: bold;
      font-size: 1.08rem;
      padding: 0.5rem 1.2rem;
      border-radius: 6px;
      display: block;
      transition: background 0.2s, color 0.2s;
    }

    .nav-menu > li > a:hover,
    .nav-menu > li > a:focus {
      background: #04528a;
      color: #afbdff;
      outline: none;
    }

    /* Dropdown Menu */
    .dropdown-content {
      display: none;
      list-style: none; /* ✅ Remove black dots */
      position: absolute;
      background: #fff;
      min-width: 220px;
      box-shadow: 0 8px 16px rgba(0,0,0,0.08);
      z-index: 1000;
      left: 0;
      top: 100%;
      border-radius: 0 0 8px 8px;
      padding: 0.5rem 0;
    }

    .dropdown-content li {
      width: 100%;
      list-style: none; /* ✅ Remove black dots */
    }

    .dropdown-content li a {
      color: #004d99;
      padding: 0.5rem 0.8rem;
      text-decoration: none;
      display: block;
      font-weight: normal;
      font-size: 1rem;
      border-radius: 0 0 8px 8px;
      transition: background 0.2s, color 0.2s;
    }

    .dropdown-content li a:hover {
      background: #04528a;
      color: #ffffff;
    }

    .dropdown:hover .dropdown-content,
    .dropdown:focus-within .dropdown-content {
      display: block;
      opacity: 1;
      visibility: visible;
    }

    /* Mobile Menu */
    .nav-toggle {
      display: none;
    }

    @media (max-width: 900px) {
      .nav-toggle {
        display: block !important;
      }

      .nav-menu {
        flex-direction: column;
        align-items: stretch;
        width: 100%;
        background: #0073e6;
        position: absolute;
        left: 0;
        top: 60px;
        z-index: 1000;
        display: none;
        transition: max-height 0.3s ease-in-out;
      }

      .nav-menu.open {
        display: flex;
      }

      .nav-menu > li {
        width: 100%;
      }

      .nav-menu > li > a {
        margin: 0;
        padding: 1rem;
        font-size: 1.05rem;
        border-radius: 0;
        border-bottom: 1px solid #04528a;
      }

      .dropdown-content {
        position: static;
        box-shadow: none;
        min-width: 100%;
        border-radius: 0;
        padding: 0;
        display: none; /* Start hidden */
      }

      /* Show dropdown on mobile when parent clicked */
      .dropdown.open .dropdown-content {
        display: block;
      }

      .dropdown-content li a {
        padding-left: 2rem;
        font-size: 0.98rem;
      }
    }

      .responsive-table {
        display: block;
        width: 100%;
        overflow-x: auto;
        -webkit-overflow-scrolling: touch;
      }
      .responsive-table table {
        min-width: 500px;
        width: 100%;
      }

      /* Back to Top Button */
      #backToTop {
        position: fixed;
        bottom: 20px;
        right: 20px;
        z-index: 999;
        background: linear-gradient(135deg, #0073e6, #02376b);
        color: white;
        border: none;
        padding: 0.8rem;
        border-radius: 50%;
        font-size: 1.4rem;
        box-shadow: 0 6px 16px rgba(0, 0, 0, 0.25);
        cursor: pointer;
        display: none;
        transition: transform 0.3s ease, box-shadow 0.3s ease;
      }

      #backToTop:hover {
        transform: translateY(-3px);
        box-shadow: 0 8px 20px rgba(0, 0, 0, 0.35);
      }

      #backToTop:active {
        transform: scale(0.95);
      }

      #help-button {
        position: fixed;
        bottom: 30px;
        left: 30px;
        background-color: #28a745;
        color: white;
        padding: 12px 16px;
        border-radius: 30px;
        box-shadow: 0 4px 10px rgba(0, 0, 0, 0.2);
        cursor: pointer;
        font-weight: bold;
        z-index: 1000;
      }

      #mapContainer {
        display: block;
        position: relative;
      }

      #rainfallTable {
        width: 100%;
        border-collapse: collapse;
      }
      #rainfallTable th, #rainfallTable td {
        padding: 0.8rem;
        border: 1px solid #ccc;
        text-align: center;
      }
      #rainfallTable th {
        background-color: #0073e6;
        color: white;
      }

      /* Responsive adjustments */
      @media (max-width: 800px) {
        header {
          padding: 1.2rem 0.5rem 0.8rem 0.5rem;
        }
        .main-title {
          font-size: 1.2rem;
        }
        .logo-container {
          gap: 1rem;
        }
        section {
          padding: 1rem;
        }
        nav a {
          margin: 0 0.4rem;
          font-size: 0.98rem;
        }
      }

        /* Hamburger button visible on mobile */
      @media (max-width: 900px) {
      .nav-toggle {
        display: block !important;
      }
      .nav-menu {
        display: none;
        flex-direction: column;
        align-items: stretch;
        width: 100%;
        background: #0073e6;
        position: absolute;
        left: 0;
        top: 60px;
        z-index: 1000;
        padding: 2rem 0;
      }
      .nav-menu.open {
        display: flex;
      }
      .nav-menu > li {
        width: 100%;
      }
      .nav-menu > li > a {
        margin: 0;
        padding: 1rem;
        font-size: 1.05rem;
        border-radius: 0;
        border-bottom: 1px solid #04528a;
      }
      .dropdown-content {
        position: static;
        box-shadow: none;
        min-width: 100%;
        border-radius: 0;
        padding: 0;
        background: #04528a;
      }
      .dropdown-content li a {
        padding-left: 2rem;
        font-size: 0.98rem;
      }
    }

      footer {
        background-color: #003366;
        color: white;
        padding: 1rem 2rem;
        text-align: center;
        width: 100%;
        bottom: 0;
        left: 0;
        font-size: 0.9rem;
        margin-top: 2rem;
      }

      footer a {
        color: #ffd700;
        text-decoration: underline;
      }

      @media (max-width: 768px) {
        footer {
          font-size: 0.85rem;
        }
      }

        .search-bar {
          display: flex;
          justify-content: center;
          margin: 1.5rem 0;
        }
        .search-bar input[type="search"] {
          width: 120%;
          max-width: 500px;
          padding: 0.7rem 1.2rem;
          border-radius: 24px;
          border: 1px solid #ccc;
          font-size: 1rem;
          transition: box-shadow 0.2s;
        }
        .search-bar input[type="search"]:focus {
          outline: none;
          box-shadow: 0 0 0 2px #0073e6;
          border-color: #0073e6;
        }
        @media (max-width: 700px) {
          .search-bar {
            margin: 1rem 0;
          }
          .search-bar input[type="search"] {
            font-size: 0.98rem;
            padding: 0.6rem 1rem;
          }
        }
        .responsive-table table {
          min-width: 500px;
          width: 100%;
        }
        @media (max-width: 700px) {
          .responsive-table table {
            min-width: 500px;
            font-size: 0.98rem;
          }
          #hydrology-data h2 {
            font-size: 1.1rem;
          }
          #hydrology-data .map-toggle-btn {
            font-size: 0.98rem;
            padding: 0.5rem 1rem;
          }
        }
      
        #riverLevelTable th, #riverLevelTable td {
          padding: 0.8rem;
          border: 1px solid #e0e0e0;
          text-align: center;
        }
        #riverLevelTable th {
          background-color: #0073e6;
          color: white;
          font-size: 1.05em;
          letter-spacing: 0.5px;
        }
        #riverLevelTable td {
          font-size: 1em;
          background: #fff;
        }
        #riverLevelTable tr:nth-child(even) td {
          background: #f6faff;
        }
        @media (max-width: 700px) {
          #riverLevelTable, #riverLevelTable thead, #riverLevelTable tbody, #riverLevelTable tr, #riverLevelTable th, #riverLevelTable td {
            display: block;
            width: 100%;
          }
          #riverLevelTable thead {
            display: none;
          }
          #riverLevelTable tr {
            margin-bottom: 1.2em;
            border-bottom: 2px solid #0073e6;
            border-radius: 8px;
            background: #fff;
            box-shadow: 0 2px 8px rgba(0,0,0,0.04);
          }
          #riverLevelTable td {
            text-align: left;
            padding: 0.7em 1em;
            position: relative;
            border: none;
            font-size: 1em;
          }
          #riverLevelTable td:before {
            content: attr(data-label);
            font-weight: bold;
            color: #004d99;
            display: block;
            margin-bottom: 0.2em;
          }
        }
        .responsive-form-iframe {
          width: 100%;
          max-width: 700px;
          margin: 0 auto 2rem auto;
        }
        .responsive-form-iframe iframe {
          width: 100%;
          min-height: 700px;
          max-height: 1900px;
          border: none;
          background: #fff;
          display: block;
        }
        @media (max-width: 700px) {
          .responsive-form-iframe iframe {
            min-height: 520px;
            height: 100vh;
            max-height: 1500px;
          }
        }

        /* Contact Modal */
        .contact-modal {
        display: none; 
        position: fixed; 
        z-index: 2000; 
        left: 0; 
        top: 0; 
        width: 100%; 
        height: 100%;
        overflow: auto; 
        background-color: rgba(0,0,0,0.5);
      }

        .contact-modal-content {
        background-color: #fff;
        margin: 10% auto;
        padding: 20px;
        border-radius: 10px;
        width: 90%;
        max-width: 420px;
        box-shadow: 0 2px 8px rgba(0,0,0,0.3);
        animation: fadeIn 0.3s ease-in-out;
      }

      .close-contact {
        color: #aaa;
        float: right;
        font-size: 24px;
        font-weight: bold;
        cursor: pointer;
      }

      .close-contact:hover {
        color: #000;
      }

      @keyframes fadeIn {
        from { opacity: 0; transform: translateY(-20px); }
        to { opacity: 1; transform: translateY(0); }
      }

      #live-date-time {
        width: 100%;
        background: #003366;
        color: #fff;
        text-align: center;
        font-size: 1.05rem;
        font-weight: 500;
        letter-spacing: 0.5px;
        padding: 0.3rem 0;
        position: relative;
        z-index: 1001;
        display: flex;
        align-items: center;
        justify-content: center;
        gap: 1.2rem;
        flex-wrap: wrap;
      }
      #live-date-time span {
        flex: 1 1 auto;
        text-align: center;
      }
      #live-date-time button {
        background: none;
        border: none;
        color: #ffd700;
        font-size: 1.3em;
        cursor: pointer;
        margin: 0 0.2em;
      }
      #live-date-time form {
        display: inline-block;
        margin: 0 0.2em;
      }
      #live-date-time input[type="search"] {
        padding: 0.3em 0.9em;
        border-radius: 16px;
        border: none;
        font-size: 1em;
        width: 120px;
        max-width: 40vw;
      }
      #live-date-time button[type="submit"] {
        background: #ffd700;
        border: none;
        color: #003366;
        font-weight: bold;
        border-radius: 16px;
        padding: 0.3em 0.9em;
        margin-left: 0.2em;
        cursor: pointer;
      }
      #faq-btn, #contact-btn, #feedback-btn {
        font-size: 1.3em;
        cursor: pointer;
        color: #ffd700;
        margin: 0 0.2em;
    }
      #faq-btn:hover, #contact-btn:hover, #feedback-btn:hover {
        color: #fffacd;
      }
      @media (max-width: 700px) {
        #live-date-time {
          flex-direction: column;
          align-items: center;
        }
        #live-date-time span {
          margin-bottom: 0.5rem;
        }
        #live-date-time form {
          width: 100%;
          text-align: center;
        }
        #live-date-time input[type="search"] {
          width: 80%;
          max-width: none;
        }
      }
      
      .faq-section {
        max-width: 900px;
        margin: 4rem auto 2rem auto; /* Top margin bigger */
        padding: 0 1rem;
        max-height: max-content;
      }

      .faq-section h2 {
        text-align: center;     /* Centers heading */
          margin-top: 1.5rem;   /* Space above the heading */
          margin-bottom: 1rem;
      }

      /* FAQ Container */
      .faq-list {
        display: flex;
        flex-direction: column;
        gap: 1rem;
        max-width: 100;
        padding: 2rem;
      }

      /* Each FAQ Item */
      .faq-item {
        border: 1px solid #ddd;
        border-radius: 8px;
        overflow: hidden;
        background: #fff;
        transition: box-shadow 0.3s ease;
      }
      .faq-item:hover {
        box-shadow: 0 4px 10px rgba(0,0,0,0.05);
      }

      /* Question Button */
      .faq-question {
        width: 100%;
        background: #0073e6;
        color: white;
        border: none;
        text-align: left;
        padding: 12px 16px;
        font-size: 1rem;
        font-weight: 500;
        cursor: pointer;
        position: relative;
        transition: background 0.3s ease;
      }
      .faq-question:hover {
        background: #005fa3;
      }
      .faq-question:active {
        outline: none;
        box-shadow: 0 0 0 2px rgba(0, 115, 230, 0.5);
      }
  

      /* Arrow Icon */
      .faq-question::after {
        content: "▼";
        position: absolute;
        right: 16px;
        font-size: 0.85em;
        transition: transform 0.3s ease;
      }
      .faq-item.open .faq-question::after {
        transform: rotate(180deg);
      }

      /* Answer */
      .faq-answer {
        display: none;
        padding: 0 16px 12px;
        color: #333;
        font-size: 0.95rem;
        line-height: 1.5;
        margin-top: 1rem
      }
      .faq-item.open .faq-answer {
        display: block;
      }

      .leaflet-control-layers {
      font-size: 14px;
      }
      .info.legend {
        background: white;
        padding: 8px 12px;
        line-height: 1.5;
        border-radius: 6px;
        box-shadow: 0 2px 6px rgba(0,0,0,0.2);
      }
      .info.legend h4 {
        margin: 0 0 5px;
        font-size: 14px;
        font-weight: bold;
      }
      .info.legend i {
        width: 16px;
        height: 16px;
        border-radius: 50%;
        margin-right: 8px;
        opacity: 0.8;
        display: inline-block;
      }
      .info.legend i.rain {
        background-color: #0073e6;
      }
      .info.legend i.water-level {
        background-color: #28a745;
      }
      .info.legend i.flood-warning {
        background-color: #dc3545;
      }
      .info.legend i.maintenance {
        background-color: #ffc107;
      }
      /* Mobile Map Fullscreen */
      @media (max-width: 768px) {
        #mapContainer {
          position: fixed;
          top: 0;
          left: 0;
          height: 100vh !important;
          width: 100vw !important;
          z-index: 2000;
          display: none; /* Hidden by default, toggled with button */
        }
        #map {
          height: 100% !important;
          width: 100% !important;
        }
        #closeMapBtn {
          position: absolute;
          top: 12px;
          right: 12px;
          background: rgba(0, 0, 0, 0.7);
          color: white;
          border: none;
          border-radius: 4px;
          padding: 6px 12px;
          z-index: 3000;
          font-size: 14px;
        }
      }

      .lang-switcher {
        display: flex;
        gap: 0.3rem;
      }

      .lang-btn {
        background: white;
        color: #0073e6;
        border: none;
        padding: 5px 12px;
        font-size: 0.9rem;
        border-radius: 4px;
        cursor: pointer;
        transition: background 0.2s ease, color 0.2s ease;
      }

      .lang-btn:hover {
        background: #0073e6;
        color: white;
      }

      .main-nav {
        top: 1.2rem; /* height of the date-time bar */
        background: #0073e6;
        z-index: 1000;
        box-shadow: 0 2px 8px rgba(0,0,0,0.04);
      }

      .nav-menu, .dropdown-content {
        list-style: none;
        margin: 0;
        padding: 0;
      }

      .nav-toggle {
        display: none;
        background: none;
        color: white;
        border: none;
        font-size: 1.5rem;
        padding: 0.5rem 1rem;
        cursor: pointer;
      }

      /* Mobile menu */
      @media (max-width: 900px) {
        .nav-toggle { display: block; }
        .nav-menu {
          display: none;
          flex-direction: column;
          background: #0073e6;
          width: 100%;
        }
        .nav-menu.open { display: flex; }
        .nav-menu > li > a {
          padding: 1rem;
          border-bottom: 1px solid #005fa3;
          display: block;
          color: white;
        }
        .dropdown-content {
          display: none;
          background: #0062cc;
        }
        .dropdown-content li a {
          padding: 0.8rem 1.5rem;
          display: block;
          color: white;
        }
        .dropdown.open .dropdown-content {
          display: block;
        }
      }

    /* Language Switch Button */
    .lang-switch {
      background: #ffd700;
      color: #333;
      padding: 0.4rem 0.8rem;
      border-radius: 4px;
      cursor: pointer;
      font-weight: bold;
      margin-left: 0.5rem;
    }
    .lang-switch:hover {
      background: #ffcc00;
    }
    .lang-switch:focus {
      outline: none;
      box-shadow: 0 0 0 2px #0073e6;
    }
    .lang-switch:active {
      background: #e6b800;
    }
    .lang-switch:disabled {
      background: #ccc;
      cursor: not-allowed;
    }
    .lang-switch:disabled:hover {
      background: #ccc;
    }

  </style>
</head>

<body>

  <!-- Top Utility Bar -->
<div id="live-date-time" 
  style="width:100%;background:#003366;color:#fff;text-align:center;font-size:1.05rem;font-weight:500;letter-spacing:0.5px;padding:0.3rem 0;position:relative;top:0;z-index:1001;display:flex;align-items:center;justify-content:center;gap:1.2rem;flex-wrap:wrap;">
  <span id="date-time-text" style="flex:1 1 auto;text-align:center;"></span>

  <!-- Utility Icons -->
  <button id="faq-btn" title="Soalan Lazim" style="background:none;border:none;color:#ffd700;font-size:1.3em;cursor:pointer;margin:0 0.2em;">
    <span aria-label="FAQ" role="img">❓</span>
  </button>
  <button id="contact-btn" title="Hubungi Kami" style="background:none;border:none;color:#ffd700;font-size:1.3em;cursor:pointer;margin:0 0.2em;">
    <span aria-label="Contact" role="img">📞</span>
  </button>
  <button id="feedback-btn" title="Maklum Balas" style="background:none;border:none;color:#ffd700;font-size:1.3em;cursor:pointer;margin:0 0.2em;">
    <span aria-label="Maklum Balas" role="img">💬</span>
  </button>

  <!-- Search -->
  <form id="header-search-form" style="display:inline-block;margin:0 0.2em;">
    <input id="header-search-input" type="search" placeholder="Cari..." 
      style="padding:0.3em 0.9em;border-radius:16px;border:none;font-size:1em;width:280px;max-width:60vw;">
    <button type="submit" style="background:#ffd700;border:none;color:#003366;font-weight:bold;border-radius:16px;padding:0.3em 0.9em;margin-left:0.2em;cursor:pointer;">
      Cari
    </button>
  </form>

  <!-- Language Switch -->
  <div class="lang-switcher" style="margin-left:auto; padding:0.5rem;">
    <button class="lang-btn" data-lang="bm" style="background:#fff;color:#0073e6;border:none;padding:5px 10px;margin-right:5px;border-radius:4px;cursor:pointer;">BM</button>
    <button class="lang-btn" data-lang="en" style="background:#fff;color:#0073e6;border:none;padding:5px 10px;border-radius:4px;cursor:pointer;">EN</button>
  </div>
</div>


</div>
  <!-- Header with Logos -->
  <header style="cursor:pointer;" onclick="window.location.href='index.html'">
    <div class="logo-container">
      <img src="jpslogo.png" alt="Logo JPS Kuala Nerus" style="cursor:pointer;">
      <img src="trglogo.png" alt="Logo SUK Terengganu" style="cursor:pointer;">
    </div>
    <h1 class="main-title" style="cursor:pointer;">JABATAN PENGAIRAN DAN SALIRAN DAERAH KUALA NERUS</h1>
  </header>

  <!-- Add this just before your <nav> ... </nav> -->
  <button class="nav-toggle" aria-label="Menu" style="display:none;position:absolute;right:1rem;top:1.1rem;background:none;border:none;font-size:2rem;color:#fff;z-index:1001;cursor:pointer;">&#9776;</button>

  <nav style="position:sticky;">
    <ul class="nav-menu">
    <li class="dropdown">
      <a href="#about" aria-haspopup="true" aria-expanded="false">Profil</a>
      <ul class="dropdown-content">
          <li><a href="#pengenalan">Pengenalan</a></li>
          <li><a href="#kata-aluan">Kata Aluan Jurutera Daerah</a></li>
          <li><a href="#visi-misi">Visi Misi Objektif</a></li>
          <li><a href="#carta-organisasi">Carta Organisasi</a></li>
        </ul>
      </li>
      <li class="dropdown">
        <a href="#services">Perkhidmatan</a>
        <ul class="dropdown-content">
          <li><a href="#ruangan-iklan">Ruangan Iklan</a></li>
          <li><a href="#ruangan-tender">Sebut Harga/Tender</a></li>
          <li><a href="#news-section">Berita</a></li>
          <li><a href="#laporan-osc">Laporan OSC</a></li>
        </ul>
      </li>
      <li class="dropdown">
        <a href="#map-section">Peta</a>
      </li>
      <li class="dropdown">
        <a href="#hydrology-data">Taburan Hujan</a>
      </li>
      <li class="dropdown">
        <a href="#repositori-dokumen">Dokumen</a>
      </li>
      <li class="dropdown">
        <a href="#">Info Banjir</a>
        <ul class="dropdown-content">
          <li>
            <a href="https://publicinfobanjir.water.gov.my/aras-air/data-paras-air/?state=TRG&lang=en" target="_blank" rel="noopener">
              Info Aras Air
            </a>
          </li>
          <li>
            <a href="https://publicinfobanjir.water.gov.my/hujan/data-hujan/?state=TRG&lang=en" target="_blank" rel="noopener">
              Info Hujan Lebat
            </a>
          </li>
          <li>
            <a href="https://jpsweb.terengganu.gov.my/index.php/ms/info-banjir/siren-amaran-banjir" target="_blank" rel="noopener">
              Siren Amaran Banjir
            </a>
          </li>
          <li>
            <a href="https://jpsweb.terengganu.gov.my/index.php/ms/info-banjir/stesen-lebat-hujan" target="_blank" rel="noopener">
              Stesen Lebat Hujan
            </a>
          </li>
          <li>
            <a href="https://jpsweb.terengganu.gov.my/index.php/ms/info-banjir/stesen-paras-air-sungai" target="_blank" rel="noopener">
              Stesen Paras Air Sungai
            </a>
          </li>
        </ul>
      </li>
    </ul>
  </nav>

  <div class="container">
    <section id="about" class="section">
      <h2>Profil Kami</h2>
  
    <p>Selamat datang ke laman web rasmi Jabatan Pengairan dan Saliran Daerah Kuala Nerus. </p>
      <p>"Jayakan Perkhidmatan Sempurna".</p>
    

      <!-- Pengenalan -->
      <section id="pengenalan" style="margin-top:2rem;">
          <h1>Pengenalan Jabatan Pengairan dan Saliran Daerah Kuala Nerus</h1>

        <section id="gallery-carousel" class="container my-5">
    <h2 class="text-center mb-4">📷 Galeri Projek JPS Kuala Nerus</h2>
    <div id="jpsGallery" class="carousel slide" data-bs-ride="carousel">
      
      <div class="carousel-inner">
        <!-- Slide 1: Before -->
        <div class="carousel-item active">
          <img src="images/before-flood1.jpg" class="d-block w-100 rounded" alt="Sebelum Banjir">
          <div class="carousel-caption d-none d-md-block bg-dark bg-opacity-50 rounded">
            <h5>Sebelum Banjir - Kg. Tepoh</h5>
            <p>Keadaan sungai sebelum pelaksanaan projek tebatan.</p>
          </div>
        </div>

        <!-- Slide 2: After -->
        <div class="carousel-item">
          <img src="images/after-flood1.jpg" class="d-block w-100 rounded" alt="Selepas Banjir">
          <div class="carousel-caption d-none d-md-block bg-dark bg-opacity-50 rounded">
            <h5>Selepas Banjir - Kg. Tepoh</h5>
            <p>Keadaan selepas pembinaan benteng dan saliran baharu.</p>
          </div>
        </div>

        <!-- Slide 3: Project Video -->
        <div class="carousel-item">
          <div class="ratio ratio-16x9">
            <iframe src="https://www.youtube.com/embed/YOUR_VIDEO_ID" title="Projek JPS" allowfullscreen></iframe>
          </div>
          <div class="carousel-caption d-none d-md-block bg-dark bg-opacity-50 rounded">
            <h5>Projek Tebatan Banjir Kuala Nerus</h5>
            <p>Video penerangan projek & impaknya.</p>
          </div>
        </div>
      </div>

      <!-- Controls -->
      <button class="carousel-control-prev" type="button" data-bs-target="#jpsGallery" data-bs-slide="prev">
        <span class="carousel-control-prev-icon bg-dark rounded-circle" aria-hidden="true"></span>
        <span class="visually-hidden">Sebelumnya</span>
      </button>
      <button class="carousel-control-next" type="button" data-bs-target="#jpsGallery" data-bs-slide="next">
        <span class="carousel-control-next-icon bg-dark rounded-circle" aria-hidden="true"></span>
        <span class="visually-hidden">Seterusnya</span>
      </button>

      <!-- Indicators -->
      <div class="carousel-indicators mt-3">
        <button type="button" data-bs-target="#jpsGallery" data-bs-slide-to="0" class="active" aria-current="true" aria-label="Slide 1"></button>
        <button type="button" data-bs-target="#jpsGallery" data-bs-slide-to="1" aria-label="Slide 2"></button>
        <button type="button" data-bs-target="#jpsGallery" data-bs-slide-to="2" aria-label="Slide 3"></button>
      </div>
    </div>
  </section>


  <p>
    Jabatan Pengairan dan Saliran (JPS) Daerah Kuala Nerus merupakan salah satu pejabat daerah di bawah pentadbiran 
    Jabatan Pengairan dan Saliran Negeri Terengganu, yang memainkan peranan penting dalam pengurusan sumber air, 
    sistem saliran bandar, tebatan banjir, serta pembangunan dan penyelenggaraan infrastruktur saliran di seluruh kawasan Kuala Nerus.
    Sebagai cabang pentadbiran yang beroperasi di peringkat daerah, JPS Kuala Nerus terdiri daripada Jurutera Daerah (J10), Penolong Jurutera Kanan (JA7), 4 Penolong Jurutera (JA5), Pelukis Pelan (JA1), Pembantu Tadbir (N1), Pembantu Tadbir Kewangan (W1) dan juga 11 Pembantu Khidmat Am (H1).
  </p>

  <p>
    Jabatan Pengairan dan Saliran Negeri Terengganu telah ditubuhkan pada tahun 1957, dan dahulunya dikenali sebagai 
    Jabatan Parit dan Taliair, ditadbir oleh Jurutera Parit dan Taliair Terengganu/Kelantan. Bermula sebagai sebuah organisasi kecil 
    dengan kurang daripada 100 orang kakitangan, kini JPS Negeri Terengganu berkembang pesat dengan lebih 500 orang pegawai dan kakitangan. 
    Ibu pejabatnya terletak di Tingkat 6, Wisma Negeri, Kuala Terengganu, dan dibantu oleh pejabat JPS di daerah-daerah termasuk JPS Daerah Kuala Nerus, 
    serta JPS Projek KETARA di Besut.
  </p>

  <p>
    Di peringkat negeri, terdapat enam bahagian utama yang menyokong pengurusan tertinggi, iaitu:
  </p>

  <ul>
    <li>Bahagian Pengairan dan Saliran</li>
    <li>Bahagian Kejuruteraan Sungai dan Pantai</li>
    <li>Bahagian Hidrologi</li>
    <li>Bahagian Khidmat Teknikal</li>
    <li>Bahagian Pentadbiran dan Kewangan</li>
    <li>Bahagian Perkhidmatan Mekanikal (beroperasi di Jalan Bukit Kecil, Kuala Terengganu)</li>
  </ul>

  <p>
    Sebagai sebahagian daripada rangkaian teknikal ini, JPS Kuala Nerus berperanan memastikan perkhidmatan berkaitan pengurusan air dan saliran 
    dilaksanakan secara efisien, berdaya saing dan mampan. Kami komited untuk memberikan perkhidmatan terbaik kepada masyarakat 
    melalui kerjasama dengan agensi teknikal, pihak berkuasa tempatan, dan komuniti setempat demi kelestarian alam dan kesejahteraan rakyat.
  </p>
      </p>
    </section>

    <!-- Kata Aluan Jurutera Daerah -->
    <section id="kata-aluan" style="margin-top:2rem;">
      <h3>Kata Aluan Jurutera Daerah</h3>
      <blockquote style="border-left:4px solid #0073e6;padding-left:1rem;color:#004d99;background:#f6faff;">
        <!-- Sila isikan kata aluan di sini. Contoh: -->
        "Selamat datang ke laman web rasmi JPS Kuala Nerus. Kami sentiasa komited dalam memberikan perkhidmatan terbaik kepada masyarakat serta memastikan pengurusan air dan saliran yang mampan untuk masa depan yang lebih sejahtera."
        <br><br>
        <span style="font-weight:bold;">Jurutera Daerah<br>JPS Kuala Nerus</span>
      </blockquote>
    </section>

    <!-- Visi Misi Objektif -->
    <section id="visi-misi" style="margin-top:2rem;">
      <div>
        <h3>Visi, Misi & Objektif</h3>
      <ul>
          <li><strong>Visi:</strong> Menjadi organisasi sektor awam antara yang unggul di dunia.</li>
      </p>
          <li><strong>Misi:</strong> Menguruskan sumber air, lembangan sungai, risiko banjir dan zon pinggir laut untuk mencapai alam sekitar yang mapan dan kualiti hidup yang dipertingkatkan.</li>
      </p>
        <li><strong>Objektif:</strong> Menyediakan perkhidmatan kejuruteraan yang melebihi keupayaan kumpulan sasaran sendiri seterusnya menjamin penggunaan tanah yang optimum dan pengurusan yang lebih cekap bagi sumber air negara.</li>
      </p>
        <li><strong>Fungsi Utama JPS:</strong>
          <ul>
            <li><b>Pengairan Dan Saliran Pertanian :</b> Membangun, mengendali dan menyelenggara kemudahan-kemudahan pengairan, saliran dan tebatan banjir serta menjalankan kerja pemeliharaan sungai bagi mendokong pembangunan dan kemajuan sektor pertanian, khususnya bagi faedah sektor pekebun-pekebun dan petani-petani kecil.</li>
            <li><b>Saliran Dan Tebatan Banjir :</b> Mengkaji, merancang dan melaksanakan kerja-kerja tebatan banjir di kawasan bandar bagi mengurangkan kejadian banjir yang berlaku di negeri ini bagi menjamin kesejahteraan hidup penduduk dan mengurangkan kerosakan harta benda.</li>
            <li><b>Kejuruteraan Sungai :</b> Mengkaji, merancang dan melaksanakan program pemeliharaan dan pemuliharaan sungai-sungai di Negeri Terengganu bagi penduduk-penduduk luar bandar dan bandar dengan melindungi nyawa, harta benda dan kawasan-kawasan pertanian serta menyediakan kemudahan rekreasi di sepanjang koridor sungai.</li>
            <li><b>Kejuruteraan Pantai :</b> Memungut data-data mengenai kejuruteraan pantai untuk mengesan hakisan dan bagi kegunaan pelbagai jabatan dan agensi kerajaan dalam perancangan dan rekabentuk projek-projek spesifik dan untuk tujuan penyelidikan. Menjalankan kerja-kerja mengawal dan mencegah hakisan pantai.</li>
            <li><b>Hidrologi Dan Sumber Air :</b> Mengumpul data hidrologi diseluruh negeri bagi memenuhi keperluan pembangunan dan pengurusan sumber air yang dikendalikan oleh pelbagai jabatan dan agensi kerajaan.</li>
            <li><b>Khidmat Nasihat Dan Sokongan :</b> Memberi ulasan terhadap permohonan pembangunan perumahan, menukar syarat kegunaan tanah, mengeluarkan tanah bukit dan perkara-perkara lain yang terlibat dengan Enakmen Air. Melaksanakan kerja-kerja kejuruteraan awam / bangunan untuk agensi lain di bawah Kementerian.</li>
          </ul>
        </li>
      </ul>
      </div>
    </section>

    <section id="carta-organisasi" style="margin-top:2rem;">
    <h3>Carta Organisasi</h3>
    <div style="text-align:center;">
      <img src="carta-organisasi-2025.png" alt="Carta Organisasi JPS Kuala Nerus 2025" style="max-width:100%;height:auto;border-radius:10px;box-shadow:0 2px 8px rgba(0,0,0,0.08);margin-bottom:1rem;">
        <p style="text-align:center;font-size:0.95em;color:#000000;margin-top:0.5rem;">
        (Klik kanan dan 'Save Image As...' untuk muat turun carta atau <a href="CARTA ORGANISASI JPS KUALA NERUS 2025.pdf" target="_blank">muat turun PDF</a>)
      </p>
    </div>

  </section>

  <!-- Add this inside your #services section, after the existing content or news section -->
<section id="laporan-osc" class="section" style="margin-top:2rem;">
  <h3>📑 Laporan Ulasan OSC</h3>
  <p>
    Senarai laporan ulasan rasmi oleh JPS Kuala Nerus yang disediakan melalui sistem OSC bagi projek pembangunan dan teknikal.
    Pengguna boleh memuat turun surat ulasan teknikal untuk rujukan dan tindakan lanjut.
  </p>
  <div class="grid">
    <!-- Contoh Laporan 1 -->
    <article>
      <h3>Projek Perumahan Bukit Tok Beng</h3>
      <ul>
        <li>📥 <a href="documents/osc/bukit-tok-beng-ulasan.pdf" download>Ulasan Teknikal JPS (PDF)</a></li>
        <li>🗓️ Tarikh Ulasan: 05 Mei 2025</li>
      </ul>
    </article>
    <!-- Contoh Laporan 2 -->
    <article>
      <h3>Pembinaan Dewan Orang Ramai Batu Rakit</h3>
      <ul>
        <li>📥 <a href="documents/osc/dewan-batu-rakit-ulasan.pdf" download>Ulasan Teknikal JPS (PDF)</a></li>
        <li>🗓️ Tarikh Ulasan: 22 April 2025</li>
      </ul>
    </article>
    <!-- Tambah lebih banyak laporan di sini -->
  </div>
</section>

  <!-- Ruangan Iklan -->
  <section id="ruangan-iklan" style="margin-top:2rem;">
    <h3>📢 Ruangan Iklan</h3>
    <div style="background:#f8fbff;border-radius:8px;padding:1rem 1.5rem;box-shadow:0 2px 8px rgba(0,0,0,0.04);margin-bottom:1rem;">
      <!-- Sila masukkan maklumat iklan di sini -->
      <p><strong>Tiada iklan terkini.</strong> Sila semak semula dari semasa ke semasa untuk makluman terbaru.</p>
    </div>
  </section>

  <!-- Ruangan Sebut Harga/Tender -->
  <section id="ruangan-tender" style="margin-top:2rem;">
    <h3>📑 Ruangan Sebut Harga / Tender</h3>
    <div style="background:#f8fbff;border-radius:8px;padding:1rem 1.5rem;box-shadow:0 2px 8px rgba(0,0,0,0.04);">
      <!-- Sila masukkan maklumat tender di sini -->
      <p><strong>Tiada sebut harga atau tender dibuka buat masa ini.</strong></p>
      <ul>
        <!-- Contoh item tender -->
        <!-- <li><a href="documents/tender-2025-01.pdf" target="_blank">Tender Projek Tebatan Banjir 2025</a> (Tutup: 30 Jun 2025)</li> -->
      </ul>
    </div>
  </section>

  <!-- Berita Terkini -->
  <section id="news-section" class="section" style="margin-top:2rem;">
  <h3>📰 Berita Terkini</h3>
  <div class="news-list" style="display: flex; flex-direction: column; gap: 1.5rem;">
    <!-- News Item 1 -->
    <article class="news-item" style="background:#f8fbff;border-radius:8px;box-shadow:0 2px 8px rgba(0,0,0,0.04);padding:1rem 1.5rem;display:flex;flex-wrap:wrap;align-items:flex-start;gap:1rem;">
      <img src="images/news/petra.jpg" alt="Skuad PETRA Menyelami Isu Hakisan Pantai Kuala Nerus" style="width:120px;max-width:100%;border-radius:8px;object-fit:cover;">
      <div style="flex:1;">
        <h4 style="margin:0 0 0.5rem 0;font-size:1.1rem;color:#004d99;">Skuad PETRA Menyelami Isu Hakisan Pantai Kuala Nerus, Terengganu</h4>
        <div style="font-size:0.95em;color:#888;margin-bottom:0.5rem;">14 Mei 2024</div>
        <p style="margin:0 0 0.5rem 0;">
          Skuad PETRA telah turun padang bagi meneliti isu hakisan pantai yang semakin membimbangkan di Kuala Nerus, Terengganu. Lawatan ini bertujuan untuk mendapatkan maklumat terkini serta mencari penyelesaian jangka panjang bersama pihak berkaitan.
        </p>
        <a href="https://jpsweb.terengganu.gov.my/index.php/ms/arkib/berita/355-skuad-petra-menyelami-isu-hakisan-pantai-kuala-nerus-terengganu" target="_blank" style="color:#0073e6;font-weight:bold;text-decoration:underline;">Baca Selanjutnya</a>
      </div>
    </article>
    <!-- News Item 2 -->
    <article class="news-item" style="background:#f8fbff;border-radius:8px;box-shadow:0 2px 8px rgba(0,0,0,0.04);padding:1rem 1.5rem;display:flex;flex-wrap:wrap;align-items:flex-start;gap:1rem;">
      <img src="images/news/lawatan-dytm.jpg" alt="Lawatan Kerja Duli Yang Teramat Mulia Yang di-Pertuan Muda Terengganu ke Tapak Hakisan Pantai" style="width:120px;max-width:100%;border-radius:8px;object-fit:cover;">
      <div style="flex:1;">
        <h4 style="margin:0 0 0.5rem 0;font-size:1.1rem;color:#004d99;">Lawatan Kerja Duli Yang Teramat Mulia Yang di-Pertuan Muda Terengganu ke Tapak Hakisan Pantai</h4>
        <div style="font-size:0.95em;color:#888;margin-bottom:0.5rem;">7 Mei 2024</div>
        <p style="margin:0 0 0.5rem 0;">
          Duli Yang Teramat Mulia Yang di-Pertuan Muda Terengganu telah mengadakan lawatan kerja ke tapak hakisan pantai di Kuala Nerus bagi meninjau keadaan semasa dan mendapatkan taklimat daripada pihak JPS serta agensi berkaitan.
        </p>
        <a href="https://jpsweb.terengganu.gov.my/index.php/ms/arkib/berita/348-lawatan-kerja-duli-yang-teramat-mulia-yang-di-pertuan-muda-terengganu-ke-tapak-hakisan-pantai" target="_blank" style="color:#0073e6;font-weight:bold;text-decoration:underline;">Baca Selanjutnya</a>
      </div>
    </article>
    <!-- Tambah berita lain di sini -->
  </div>
</section>
</section>

    <!-- Interactive Map Section -->
    <section id="map-section" class="section">
      <h2>🗺️ Peta Interaktif JPS Kuala Nerus</h2>
      <div id="mapContainer" style="position:relative;">
        <div id="map" style="height:400px;border-radius:10px;margin-top:1rem;width:100%;"></div>
      <p style="font-size:0.9em;color:#666;margin-top:0.5rem;text-align:center;">
        Peta ini menunjukkan lokasi pejabat JPS Kuala Nerus, stesen hujan, siren banjir, dan projek tebatan banjir di sekitar Kuala Nerus.
        Klik pada ikon untuk maklumat lanjut.
      </p>
      <button id="closeMapBtn" style="display:none;">✖ Tutup Peta</button>
    </section>

  <!-- Leaflet JS -->
  <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"></script>

  <script>
  document.addEventListener("DOMContentLoaded", () => {
    const mapContainer = document.getElementById("mapContainer");
    const toggleMapBtn = document.getElementById("toggleMap");

    const map = L.map("map").setView([5.39448, 103.06308], 12);

    L.tileLayer("https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png", {
      attribution: '&copy; OpenStreetMap contributors'
    }).addTo(map);

    const makeIcon = (color) =>
      new L.Icon({
        iconUrl: `https://cdn.jsdelivr.net/gh/pointhi/leaflet-color-markers@master/img/marker-icon-${color}.png`,
        shadowUrl: 'https://unpkg.com/leaflet@1.7.1/dist/images/marker-shadow.png',
        iconSize: [25, 41],
        iconAnchor: [12, 41],
        popupAnchor: [1, -34],
        shadowSize: [41, 41]
      });

    const icons = {
      pejabat: makeIcon("blue"),
      siren: makeIcon("red"),
      hujan: makeIcon("green"),
      arasAir: makeIcon("yellow"),
      projek: makeIcon("violet")
    };

    const pejabatLayer = L.layerGroup([
      L.marker([5.39448, 103.06308], { icon: icons.pejabat })
        .bindPopup("<b>Pejabat JPS Kuala Nerus</b>")
    ]);

    const sirenLayer = L.layerGroup([
      L.marker([5.4145, 103.0855], { icon: icons.siren }).bindPopup("Siren Banjir Tok Jembal"),
      L.marker([5.4630, 103.1020], { icon: icons.siren }).bindPopup("Siren Banjir Batu Rakit"),
      L.marker([5.3660, 103.0990], { icon: icons.siren }).bindPopup("Siren Banjir Seberang Takir")
    ]);

    const hujanLayer = L.layerGroup([
      L.marker([5.3950, 103.0850], { icon: icons.hujan })
        .bindPopup(`<b>Stesen Hujan Gong Badak</b><br>Hujan: <b>22 mm</b><br>Kemaskini: 9:45 AM`),
      L.marker([5.4600, 103.1000], { icon: icons.hujan })
        .bindPopup(`<b>Stesen Hujan Batu Rakit</b><br>Hujan: <b>8 mm</b><br>Kemaskini: 9:45 AM`)
    ]);

    const arasAirLayer = L.layerGroup([
      L.marker([5.4000, 103.0700], { icon: icons.arasAir })
        .bindPopup(`
          <b>Stesen Aras Air Sungai Nerus</b><br>
          Aras Air: <b>4.5 m</b><br>
          Status: <span style="color:red;font-weight:bold;">Bahaya 🚨</span>
        `),
      L.marker([5.3700, 103.0720], { icon: icons.arasAir })
        .bindPopup(`
          <b>Stesen Aras Air Taman Ilmu</b><br>
          Aras Air: <b>2.3 m</b><br>
          Status: <span style="color:orange;font-weight:bold;">Waspada ⚠️</span>
        `),
      L.marker([5.4300, 103.0600], { icon: icons.arasAir })
        .bindPopup(`
          <b>Stesen Aras Air Batu Rakit</b><br>
          Aras Air: <b>1.2 m</b><br>
          Status: <span style="color:green;font-weight:bold;">Normal ✅</span>
        `)
    ]);

    const projekLayer = L.layerGroup([
      L.marker([5.40788, 103.0886], { icon: icons.projek }).bindPopup("Projek Tebatan Banjir UMT")
    ]);

    // Optional: Example polygon (Zon Risiko)
    const floodZoneLayer = L.layerGroup([
      L.polygon([
        [5.407, 103.08],
        [5.412, 103.09],
        [5.409, 103.095],
        [5.404, 103.085]
      ], {
        color: "brown",
        fillOpacity: 0.4
      }).bindPopup("Zon Risiko Banjir")
    ]);

    // Add to map by default
    pejabatLayer.addTo(map);
    sirenLayer.addTo(map);
    hujanLayer.addTo(map);
    arasAirLayer.addTo(map);
    projekLayer.addTo(map);
    floodZoneLayer.addTo(map);

      const overlayMaps = {
    // your existing layers...
    "🟦 Pejabat JPS": pejabatLayer,
    "🔴 Siren Banjir": sirenLayer,
    "🟩 Stesen Hujan": hujanLayer,
    "🟨 Aras Air Sungai": arasAirLayer,
    "🟪 Projek Tebatan Banjir": projekLayer,
    "🟫 Zon Risiko Banjir": floodZoneLayer,
    "🌊 Paras Sungai & Hujan": hydroLayer
  };

  L.control.layers(null, overlayMaps, { collapsed: false }).addTo(map);

    // Add scale control
    L.control.scale({
      position: "bottomright",
      maxWidth: 100,
      imperial: false
    }).addTo(map);
    // Add attribution control
    L.control.attribution({
      position: "bottomleft",
      prefix: '© <a href="https://www.openstreetmap.org/copyright" target="_blank">OpenStreetMap</a> contributors'
    }).addTo(map);

    // Toggle Button
    toggleMapBtn.addEventListener("click", () => {
      const isHidden = mapContainer.style.display === "none";
      mapContainer.style.display = isHidden ? "block" : "none";
      toggleMapBtn.textContent = isHidden ? "Sembunyikan Peta" : "Lihat Peta";
      if (!isHidden) setTimeout(() => map.invalidateSize(), 300);
    });

    setTimeout(() => map.invalidateSize(), 500);
  });

    const hydroLayer = L.layerGroup();

    hydroStations.forEach(station => {
      const statusColor = station.river_status === 'Normal' ? '#28a745' :
                          station.river_status === 'Amaran' ? '#ffc107' :
                          '#dc3545';

      const marker = L.marker(station.coords, {
        icon: hydroIcons[station.river_status]
      }).bindPopup(`
        <strong>${station.name}</strong><br>
        Paras Air: ${station.river_level} m<br>
        Status: <span style="color:${statusColor}; font-weight:bold;">${station.river_status}</span><br>
        Jumlah Hujan: ${station.rainfall} mm<br>
        Kemaskini: ${station.last_update}
      `);

      hydroLayer.addLayer(marker);
    });

    hydroLayer.addTo(map);

</script>


  <script>
  // --- Hydrology Cluster Markers ---
  // Only run after map is initialized
  function addHydroClusters() {
    if (!window.map || typeof L === "undefined") return;

    // Example dynamic river/rainfall data for markers
    const hydroStations = [
      {
        name: "Stesen Aras Air Sungai Nerus",
        coords: [5.4000, 103.0700],
        river_level: 1.8,
        river_status: "Normal",
        rainfall: 14.2,
        last_update: "2025-06-18 15:00"
      },
      {
        name: "Stesen Aras Air Sungai Tepoh",
        coords: [5.4200, 103.0800],
        river_level: 2.5,
        river_status: "Amaran",
        rainfall: 9.7,
        last_update: "2025-06-18 14:45"
      },
      {
        name: "Stesen Aras Air Sungai Batu Rakit",
        coords: [5.4600, 103.1000],
        river_level: 3.1,
        river_status: "Bahaya",
        rainfall: 11.5,
        last_update: "2025-06-18 14:30"
      }
    ];

    // Color-coded icon URLs
    const hydroIcons = {
      "Normal": new L.Icon({
        iconUrl: 'https://cdn.jsdelivr.net/gh/pointhi/leaflet-color-markers@master/img/marker-icon-green.png',
        shadowUrl: 'https://unpkg.com/leaflet@1.7.1/dist/images/marker-shadow.png',
        iconSize: [25, 41],
        iconAnchor: [12, 41],
        popupAnchor: [1, -34],
        shadowSize: [41, 41]
      }),
      "Amaran": new L.Icon({
        iconUrl: 'https://cdn.jsdelivr.net/gh/pointhi/leaflet-color-markers@master/img/marker-icon-yellow.png',
        shadowUrl: 'https://unpkg.com/leaflet@1.7.1/dist/images/marker-shadow.png',
        iconSize: [25, 41],
        iconAnchor: [12, 41],
        popupAnchor: [1, -34],
        shadowSize: [41, 41]
      }),
      "Bahaya": new L.Icon({
        iconUrl: 'https://cdn.jsdelivr.net/gh/pointhi/leaflet-color-markers@master/img/marker-icon-red.png',
        shadowUrl: 'https://unpkg.com/leaflet@1.7.1/dist/images/marker-shadow.png',
        iconSize: [25, 41],
        iconAnchor: [12, 41],
        popupAnchor: [1, -34],
        shadowSize: [41, 41]
      })
    };
    // Create a cluster group
    const hydroCluster = L.markerClusterGroup({
      showCoverageOnHover: false,
      spiderfyOnMaxZoom: true,
      zoomToBoundsOnClick: true
    });

    // Add markers to the cluster
    hydroStations.forEach(station => {  
      const marker = L.marker(station.coords, {
        icon: hydroIcons[station.river_status]
      }).bindPopup(`
        <strong>${station.name}</strong><br>
        Paras Air: ${station.river_level} m<br>
        Status: ${station.river_status}<br>
        Jumlah Hujan: ${station.rainfall} mm<br>
        Kemaskini: ${station.last_update}
      `);
      hydroCluster.addLayer(marker);
    });

    // Add the cluster to the map
    map.addLayer(hydroCluster);
    mapInitialized = true;
  }

    // Initialize map and add clusters
    initMap();
    addHydroClusters();

    // Toggle map visibility
    toggleMapBtn.addEventListener("click", () => {
      if (mapContainer.style.display === "none") {
        mapContainer.style.display = "block";
        toggleMapBtn.textContent = "Sembunyikan Peta";
      } else {
        mapContainer.style.display = "none";
        toggleMapBtn.textContent = "Tunjukkan Peta";
      }
    });
  </script>

  <section id="services-section" class="section">
    <h2>Perkhidmatan Kami</h2>
    <ul>
      <li><strong>Pengurusan Sumber Air:</strong> Memastikan kualiti dan kuantiti sumber air terpelihara untuk kegunaan masyarakat.</li>
      <li><strong>Tebatan Banjir:</strong> Membangun dan menyelenggara sistem tebatan banjir untuk mengurangkan risiko banjir di kawasan bandar.</li>
      <li><strong>Penyelenggaraan Sungai:</strong> Melaksanakan kerja-kerja penyelenggaraan sungai untuk memastikan aliran air yang lancar dan mengelakkan hakisan.</li>
      <li><strong>Rekod Hujan dan Aras Air:</strong> Mengumpul data hujan dan aras air untuk analisis dan perancangan pengurusan sumber air.</li>
    </ul>
  </section>

<!-- Rainfall Data Section with Download as CSV -->
<section id="hydrology-data" class="section">
  <h2>Taburan Hujan Kuala Nerus</h2>
  <button id="toggleView" class="map-toggle-btn">Tukar kepada Carta 📈</button>

  <div class="responsive-table">
    <table id="rainfallTable">
      <thead>
        <tr>
          <th>Stesen</th>
          <th>Jumlah Hujan (mm)</th>
          <th>Kemaskini</th>
        </tr>
      </thead>
      <tbody id="rainfallTableBody">
        <!-- Data will be inserted here -->
      </tbody>
    </table>
  </div>
  <div id="rainfall-chart-view" style="display:flex; align-items: center; gap:0.5rem;">
    <canvas id="rainChart" height="300"></canvas>
  </div>
</section>

  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
  <script>
    // Rainfall data
    const rainfallData = [
      { station: "Stesen Hujan Gong Badak", rainfall: 12.5, lastUpdate: "2025-06-18 15:00" },
      { station: "Stesen Hujan Batu Rakit", rainfall: 8.3, lastUpdate: "2025-06-18 14:45" },
      { station: "Stesen Hujan Seberang Takir", rainfall: 10.1, lastUpdate: "2025-06-18 14:30" }
    ];

    // Populate the table
    const rainfallTableBody = document.getElementById("rainfallTableBody");
    rainfallData.forEach(data => {
      const row = document.createElement("tr");
      row.innerHTML = `
        <td>${data.station}</td>
        <td>${data.rainfall} mm</td>
        <td>${data.lastUpdate}</td>
      `;
      rainfallTableBody.appendChild(row);
    });

    // Initialize Chart.js
    const ctx = document.getElementById("rainChart").getContext("2d");
    const rainChart = new Chart(ctx, {
      type: 'bar',
      data: {
        labels: rainfallData.map(d => d.station),
        datasets: [{
          label: 'Jumlah Hujan (mm)',
          data: rainfallData.map(d => d.rainfall),
          backgroundColor: 'rgba(54, 162, 235, 0.6)',
          borderColor: 'rgba(54, 162, 235, 1)',
          borderWidth: 0.5
        }]
      },
      options: {
        responsive: true,
        scales: {
          yAxes: [{
            ticks: {
              beginAtZero:true
            }
          }]
        }
      }
    });

    // Toggle view between table and chart
    document.getElementById("toggleView").addEventListener("click", () => {
      const tableView = document.querySelector("#rainfallTable");
      const chartView = document.querySelector("#rainfall-chart-view");
      if (tableView.style.display === "none") {
        tableView.style.display = "table";
        chartView.style.display = "none";
        document.getElementById("toggleView").textContent = "Tukar kepada Carta 📈";
      } else {
        tableView.style.display = "none";
        chartView.style.display = "block";
        document.getElementById("toggleView").textContent = "Tukar kepada Jadual 📊";
      }
    });
    
    // Initialize with table view
    document.querySelector("#rainfallTable").style.display = "table";
    document.querySelector("#rainfall-chart-view").style.display = "none";
  </script>

  <!-- Enhanced River Level Section (UI/UX & Mobile Friendly) -->
  <section id="river-level" class="section">
    <h2 style="display:flex;align-items:center;gap:0.5rem;">
      <span style="font-size:1.5em;"></span> Aras Air Sungai – Kuala Nerus
    </h2>
    <div class="responsive-table">
      <table id="riverLevelTable" style="width:100%;border-collapse:collapse;">
        <thead>
          <tr>
            <th>Stesen</th>
            <th>Paras Air (m)</th>
            <th>Status</th>
            <th>Kemaskini</th>
          </tr>
        </thead>
        <tbody>
          <!-- Filled by JS -->
        </tbody>
      </table>
    </div>
    <div id="river-legend" style="margin-top:1rem;font-size:0.97em;">
      <strong>Status:</strong>
      <span style="background:#d4edda;color:#155724;padding:2px 10px;border-radius:12px;margin-right:8px;display:inline-block;">🟢 Normal</span>
      <span style="background:#fff3cd;color:#856404;padding:2px 10px;border-radius:12px;margin-right:8px;display:inline-block;">🟡 Amaran</span>
      <span style="background:#f8d7da;color:#721c24;padding:2px 10px;border-radius:12px;display:inline-block;">🔴 Bahaya</span>
    </div>
    <p style="font-size:0.9em;color:#666;margin-top:0.5rem;text-align:center;">
      Data aras air terkini dari stesen-stesen utama di Kuala Nerus. Klik pada nama stesen untuk maklumat lanjut.
    </p>
  </section>

    <section id="repositori-dokumen" class="section">
      <h2>Repositori Dokumen</h2>
      <p>Muat turun borang rasmi, panduan teknikal, dan dokumen tender terkini daripada JPS Kuala Nerus.</p>

      <div class="grid">
        <article>
          <h3>📄 Borang Permohonan</h3>
          <ul>
            <li><a href="documents/permit-sungai.pdf" download>Permohonan Rezab Sungai</a></li>
            <li><a href="documents/water-extraction.pdf" download>Permohonan Pengekstrakan Air</a></li>
          </ul>
        </article>
        <article>
          <h3>📘 Panduan Banjir</h3>
          <ul>
            <li><a href="documents/flood-safety.pdf" download>Panduan Pengurusan Banjir</a></li>
            <li><a href="documents/emergency-plan.pdf" download>Pelan Kecemasan</a></li>
          </ul>
        </article>
        <article>
          <h3>📋 Dokumen Tender</h3>
          <ul>
            <li><a href="documents/tender-guidelines.pdf" download>Garis Panduan Tender</a></li>
            <li><a href="documents/bid-requirements.pdf" download>Keperluan Bidaan</a></li>
          </ul>
        </article>
      </div>
      <p style="font-size:0.9em;color:#666;margin-top:0.5rem;text-align:center;">
        Untuk maklumat lanjut atau dokumen lain, sila hubungi pejabat kami.
    </section>

      <!-- Borang Maklum Balas -->
      <section id="borang-maklum-balas" style="margin-bottom:2rem;">
        <h3>Borang Maklum Balas</h3>
          <!-- For Borang Maklum Balas -->
        <div class="responsive-form-iframe">
          <iframe src="https://docs.google.com/forms/d/e/1FAIpQLScOg2tc-4SLojMGjwKtnZxazyVi4At98-2A1B13EdXc0oIebw/viewform?embedded=true" allowfullscreen>Memuatkan…</iframe>
        </div>
    </section>
    </div>

    <!-- Add this before your footer, after the contact section -->
    <section id="faq" class="section" style=" max-width: 1100px; margin: 2rem auto; margin-top: 1.5rem; "> 
      <h2>❓ Soalan Lazim (Frequently Asked Question)</h2>
      <div class="faq-list" style="display:flex;flex-direction:column;gap:1.5rem;">
          <div class="faq-item">
          <button class="faq-question">1. Adakah JPS bertanggungjawab terhadap masalah air paip?</button>
          <div class="faq-answer">
            <p>JPS tidak bertanggungjawab terhadap bekalan air domestik atau industri anda kerana JPS hanya bertanggungjawab terhadap bekalan air pengairan untuk petani/peladang. Sila hubungi pihak berkuasa yang berkaitan seperti Jabatan Kerja Air Negeri, Jabatan Kerja Raya atau syarikat air / lembaga air yang sesuai yang bertanggungjawab terhadap bekalan air di kawasan anda.</p>
          </div>
        </p>

          <div class="faq-item">
          <button class="faq-question">2. Kepada siapakah harus saya mengadu untuk masalah saliran tempatan atau banjir kilat?</button>
          <div class="faq-answer">
            <p>JPS dan juga pihak berkuasa tempatan bertanggungjawab yang berkenaan terhadap saliran.  Secara umum pihak berkuasa tempatan bertanggungjawab terhadap pembinaan dan penyelenggaraan sistem saliran tempatan yang sebahagian besarnya merupakan saliran utama dan saliran sekunder.  JPS bertanggungjawab terhadap sungai yang mungkin mengalir di dalam dan di luar kawasan pihak berkuasa tempatan. Banjir yang disebabkan oleh parit dan pembetung yang tersumbat jatuh di bawah tanggungjawab pihak berkuasa tempatan. Banjir yang disebabkan oleh limpahan parit dan sungai akibat keupayaan yang tidak mencukupi biasanya merupakan tanggungjawab JPS.  Sekiranya ragu-ragu sila hubungi PRO pejabat JPS yang terdekat. JPS mempunyai pejabat PRO di setiap negeri.</p>
          </div>
        </p>

          <div class="faq-item">
          <button class="faq-question">3. Bagaimanakah saya boleh mendapatkan maklumat tentang paras air sungai dan hujan di kawasan saya?</button>
          <div class="faq-answer">
            <p>Maklumat ini diterbitkan setiap tahun oleh Bahagian Hidrologi Jabatan Pengairan dan Saliran yang terletak di Cawangan Ibu Pejabat di Jalan Ampang (Tel: 03-4256 2657).  Bahagian Hidrologi kini sedang membangunkan suatu sistem pangkalan data yang dikenali sebagai Sistem Maklumat Hidrografi (HIS - Hydrologic Information System) yang berupaya untuk membekalkan maklumat dalam talian. JPS juga mengumpul beberapa maklumat tentang kualiti air terutamanya tentang beban endapan. Untuk butir-butir lanjut,  http://h2o.water.gov.my/</p>
          </div>
        </p>

          <div class="faq-item">
          <button class="faq-question">4. Bolehkah sesiapa memohon untuk menggunakan tanah yang ditetapkan sebagai "Rizab Sungai"?</button>
          <div class="faq-answer">
            <p>Secara umumnya JPS tidak menggalakkan permohonan untuk menggunakan rizab sungai kita kerana kami perlu memasukinya pada bila-bila masa untuk kerja pembaikan kecemasan dan juga untuk penyelenggaraan sungai. Walau bagaimanapun, kami mungkin mempertimbangkan permohonan tertentu berdasarkan kes demi kes.</p>
          </div>
        </p>

          <div class="faq-item">
          <button class="faq-question">5. Bagaimanakah saya boleh mendapatkan maklumat tentang projek JPS yang telah siap?</button>
          <div class="faq-answer">
            <p>Anda boleh menghubungi pejabat JPS terdekat atau melayari laman web rasmi JPS untuk mendapatkan maklumat mengenai projek-projek yang telah siap.</p>
          </div>
        </p>

          <div class="faq-item">
          <button class="faq-question">6. Bagaimanakah saya boleh melaporkan masalah banjir atau saliran di kawasan saya?</button>
          <div class="faq-answer">
            <p>Anda boleh melaporkan masalah banjir atau saliran melalui laman web rasmi JPS atau menghubungi pejabat JPS terdekat. Pastikan untuk memberikan butiran yang lengkap mengenai lokasi dan jenis masalah yang dihadapi.</p>
          </div>
        </p>

          <div class="faq-item">
          <button class="faq-question">7. Apakah peranan JPS Kuala Nerus?</button>
          <div class="faq-answer">
            <p>JPS bertanggungjawab dalam pengurusan air, mitigasi banjir, penyelenggaraan sistem saliran dan pelaksanaan projek berkaitan sumber air di daerah Kuala Nerus.</p>
          </div>
        </p>

          <div class="faq-item">
          <button class="faq-question">8. Bagaimanakah saya boleh mendapatkan maklumat tentang projek JPS yang sedang berjalan?</button>
          <div class="faq-answer">
            <p>Anda boleh menghubungi pejabat JPS terdekat atau melayari laman web rasmi JPS untuk mendapatkan maklumat terkini mengenai projek-projek yang sedang dijalankan.</p>
          </div>
        </p>

          <div class="faq-item">
          <button class="faq-question">9. Adakah JPS Kuala Nerus menyediakan perkhidmatan khidmat nasihat teknikal?</button>
          <div class="faq-answer">
            <p>Ya, JPS Kuala Nerus menyediakan perkhidmatan khidmat nasihat teknikal berkaitan pengurusan air, saliran dan projek pembangunan. Anda boleh menghubungi pejabat kami untuk mendapatkan bantuan.</p>
          </div>
        </p>
    </section>

    <button id="backToTop" aria-label="Kembali ke atas"
      style="position:fixed;bottom:30px;right:30px;z-index:999;background:#bd12e7;color:#fff;border:none;padding:0.8rem 1rem;border-radius:50%;font-size:1.2rem;box-shadow:0 6px 16px rgba(0,0,0,0.2);cursor:pointer;display:none;">
      ↑
    </button>
    <button id="help-button" aria-label="Bantuan"
      style="position:fixed;bottom:30px;left:30px;background:#28a745;color:#fff;padding:0.7rem 1.2rem;border-radius:22px;box-shadow:0 4px 12px rgba(0,0,0,0.10);cursor:pointer;font-weight:600;z-index:1000;">
      Bantuan
    </button>

<footer>
  <div class="footer-main" style="width:100%;margin:0;padding:2.5rem 0 1.2rem 0;background:#004080;">
    <div class="footer-grid" style="display:flex;flex-wrap:wrap;gap:2rem;justify-content:space-between;align-items:flex-start;padding:0 4vw;">
      <!-- JPS Info -->
      <div class="footer-col" style="flex:1 1 220px;min-width:200px;text-align:left;">
        <div style="display:flex;align-items:center;gap:0.7rem;">
          <img src="jpslogo.png" alt="Logo JPS" style="height:38px;width:auto;border-radius:6px;box-shadow:0 2px 8px rgba(0,0,0,0.08);background:#004080;">
          <span style="font-size:1.15em;font-weight:700;letter-spacing:0.5px;color:#ffd700;">Jabatan Pengairan dan Saliran Daerah Kuala Nerus</span>
        </div>
        <div style="margin-top:0.7em;font-size:0.97em;color:#fff;">
          Bangunan Gunasama,<br>
          Kompleks Pentadbiran Bandar Al Wathiqu Billah,<br>
          21300 Kuala Nerus, Terengganu Darul Iman.
        </div>
      </div>
      <!-- Contact -->
      <div class="footer-col" style="flex:1 1 220px;min-width:200px;">
        <div style="font-weight:700;font-size:1.08em;margin-bottom:0.5em;color:#ffd700;">Hubungi Kami</div>
        <div style="font-size:0.97em;color:#fff;">
          📞 <a href="tel:+6096653010" style="color:#ffd700;">+60 9-665 3010</a><br>
          📱 <a href="https://wa.me/60123456789" target="_blank" style="color:#ffd700;">+60 12-345 6789</a><br>
          📧 <a href="mailto:jpskualanerus@terengganu.gov.my" style="color:#ffd700;">jpskualanerus@terengganu.gov.my</a>
        </div>
        <div style="font-size:0.97em;margin-top:0.7rem;color:#fff;">
          <span style="font-weight:600;">Waktu Operasi:</span><br>
          Ahad - Khamis: 8:00 AM - 5:00 PM<br>
          Jumaat & Sabtu: Tutup
        </div>
      </div>
      <!-- Quick Links & External -->
      <div class="footer-col" style="flex:1 1 220px;min-width:200px;">
        <div style="font-weight:700;font-size:1.08em;margin-bottom:0.5em;color:#ffd700;">Pautan Pantas</div>
        <div style="margin-bottom:0.7em;">
          <a href="#about" style="color:#ffd700;">Tentang</a> &nbsp;|&nbsp;
          <a href="#services" style="color:#ffd700;">Perkhidmatan</a> &nbsp;|&nbsp;
          <a href="#contact" style="color:#ffd700;">Hubungi</a>
        </div>
        <a href="https://jpsweb.terengganu.gov.my/index.php/ms/" target="_blank" rel="noopener"
          style="color:#fff;background:#0073e6;padding:8px 18px;border-radius:22px;text-decoration:none;display:inline-block;font-weight:600;box-shadow:0 2px 8px rgba(0,0,0,0.08);margin-top:0.5em;">
          Portal Rasmi JPS Negeri Terengganu
        </a>
      </div>
    </div>
    <div style="text-align:center;margin-top:2.2rem;">
    <hr style="margin:2rem 0 1rem 0;border:none;border-top:1px solid #0073e6;">
    <div style="font-size:0.98em;color:#e0e0e0;text-align:center;">
      &copy; 2025 Jabatan Pengairan dan Saliran Daerah Kuala Nerus. Hak cipta terpelihara.<br>
      <span style="font-size:0.95em;">Sebarang pertanyaan, sila <a href="https://wa.me/60123456789" style="color:#ffd700;">hubungi kami</a>.</span>
    </div>
  </div>
</footer>

<script src="https://unpkg.com/leaflet/dist/leaflet.js"></script>
<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
<script src="https://unpkg.com/leaflet.markercluster/dist/leaflet.markercluster.js"></script>
<script src="https://cdn.jsdelivr.net/npm/axios/dist/axios.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/leaflet-control-geocoder/dist/leaflet-control-geocoder.js"></script>
<script src="https://cdn.jsdelivr.net/npm/leaflet.fullscreen@2.0.0/dist/leaflet.fullscreen.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/leaflet.locatecontrol@0.72.0/dist/L.Control.Locate.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/leaflet-easybutton@2.5.0/src/easy-button.js"></script>
<script src="https://cdn.jsdelivr.net/npm/leaflet-ajax@2.1.0/dist/leaflet-ajax.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/leaflet-control-layers-overpass@1.0.0/dist/leaflet-control-layers-overpass.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/leaflet-omnivore@0.3.0/leaflet-omnivore.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/leaflet-velocity@0.1.0/dist/leaflet-velocity.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/leaflet-heat@0.2.0/dist/leaflet-heat.js"></script>
<script src="https://cdn.jsdelivr.net/npm/leaflet-draw@1.0.4/dist/leaflet.draw.js"></script>
<script src="https://cdn.jsdelivr.net/npm/leaflet-search@2.9.0/dist/leaflet-search.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/leaflet-responsive-popup@1.0.0/dist/leaflet-responsive-popup.min.js"></script>

<script>
  
  // LIVE DATE/TIME DISPLAY AND HELP MODAL
  document.addEventListener("DOMContentLoaded", function () {
    function updateClock() {
      const now = new Date();
      const days = ["Ahad", "Isnin", "Selasa", "Rabu", "Khamis", "Jumaat", "Sabtu"];
      const months = ["Januari", "Februari", "Mac", "April", "Mei", "Jun", "Julai", "Ogos", "September", "Oktober", "November", "Disember"];
      const day = days[now.getDay()];
      const date = now.getDate();
      const month = months[now.getMonth()];
      const year = now.getFullYear();
      const time = now.toLocaleTimeString('ms-MY', { hour: '2-digit', minute: '2-digit', second: '2-digit' });
      document.getElementById("date-time-text").textContent = `${day}, ${date} ${month} ${year} | ${time}`;
    }
    updateClock();
    setInterval(updateClock, 1000);

    // HELP MODAL
    const helpButton = document.getElementById("help-button");
    helpButton.addEventListener("click", function () {
      if (!document.getElementById("help-modal")) {
        const modal = document.createElement("div");
        modal.id = "help-modal";
        modal.style.cssText = "position:fixed;top:0;left:0;width:100vw;height:100vh;background:rgba(0,0,0,0.4);z-index:2000;display:flex;align-items:center;justify-content:center;";
        modal.innerHTML = `
          <div style="background:#fff;padding:2rem 1.5rem;border-radius:16px;max-width:350px;width:90%;box-shadow:0 8px 32px rgba(0,0,0,0.18);text-align:left;position:relative;">
            <button id="close-help-modal" aria-label="Tutup Bantuan" style="position:absolute;top:10px;right:14px;background:none;border:none;font-size:1.5em;color:#0073e6;cursor:pointer;">&times;</button>
            <h3 style="color:#0073e6;margin-top:0;">Bantuan Laman Web</h3>
            <ul style="padding-left:1.2em;font-size:1em;">
              <li>Untuk pertanyaan, klik <a href="#contact" style="color:#0073e6;">Hubungi Kami</a>.</li>
              <li>Untuk maklum balas, klik <a href="#borang-maklum-balas" style="color:#0073e6;">Borang Maklum Balas</a>.</li>
              <li>Untuk soalan lazim, klik <a href="#faq" style="color:#0073e6;">Soalan Lazim (FAQ)</a>.</li>
              <li>Gunakan carian di atas untuk mencari info di laman ini.</li>
            </ul>
            <div style="margin-top:1.2em;font-size:0.98em;color:#666;">
              Jika anda perlukan bantuan lanjut, sila hubungi JPS Kuala Nerus di <br>
              <a href="mailto:jpskualanerus@terengganu.gov.my" style="color:#0073e6;">jpskualanerus@terengganu.gov.my</a>
            </div>
          </div>`;
        document.body.appendChild(modal);
        document.getElementById("close-help-modal").onclick = () => modal.remove();
        modal.onclick = e => { if (e.target === modal) modal.remove(); };
      }
    });
  });

    // Header Buttons
    document.getElementById("faq-btn").onclick = function() {
      window.location.href = "#faq";
    };
    document.getElementById("contact-btn").onclick = function() {
      window.location.href = "#contact";
    };
    document.getElementById("feedback-btn").onclick = function() {
      window.location.href = "#borang-maklum-balas";
    };

    // Header Search
    document.getElementById("header-search-form").onsubmit = function(e) {
      e.preventDefault();
      const q = document.getElementById("header-search-input").value.trim().toLowerCase();
      if (!q) return;
      let found = false;
      function walk(node) {
        if (found) return;
        if (node.nodeType === 3 && node.textContent.toLowerCase().includes(q)) {
          node.parentElement.scrollIntoView({ behavior: "smooth", block: "center" });
          node.parentElement.style.background = "#fff3cd";
          setTimeout(() => node.parentElement.style.background = "", 2000);
          found = true;
        } else if (node.nodeType === 1 && node.childNodes) {
          node.childNodes.forEach(walk);
        }
      }
      walk(document.body);
      if (!found) alert("Tiada padanan dijumpai.");
    };


     // Back to top button
    const backToTopBtn = document.getElementById("backToTop");
    window.addEventListener("scroll", function () {
      backToTopBtn.style.display = window.scrollY > 300 ? "block" : "none";
    });
    backToTopBtn.addEventListener("click", function () {
      window.scrollTo({ top: 0, behavior: "smooth" });
    });

    // Hamburger Menu
    const navToggle = document.querySelector('.nav-toggle');
    const navMenu = document.querySelector('.nav-menu');
    navToggle.addEventListener('click', function () {
      navMenu.classList.toggle('open');
    });

    // Add hydro stations data
    const hydroStations = [
    {
      name: "Stesen Sungai Nerus",
      coords: [5.4000, 103.0700],
      river_level: 4.5,
      river_status: "Bahaya",
      rainfall: 22,
      last_update: "09:45 AM"
    },
    {
      name: "Stesen Sungai Batu Rakit",
      coords: [5.4600, 103.1000],
      river_level: 2.3,
      river_status: "Amaran",
      rainfall: 12,
      last_update: "09:45 AM"
    },
    {
      name: "Stesen Sungai Taman Ilmu",
      coords: [5.3700, 103.0720],
      river_level: 1.1,
      river_status: "Normal",
      rainfall: 6,
      last_update: "09:45 AM"
    }
  ];

    // Define custom icons for river status
    const hydroIcons = {
      Normal: new L.Icon({
        iconUrl: 'https://cdn.jsdelivr.net/gh/pointhi/leaflet-color-markers@master/img/marker-icon-green.png',
        shadowUrl: 'https://unpkg.com/leaflet@1.7.1/dist/images/marker-shadow.png',
        iconSize: [25, 41],
        iconAnchor: [12, 41],
        popupAnchor: [1, -34],
        shadowSize: [41, 41]
      }),
      Amaran: new L.Icon({
        iconUrl: 'https://cdn.jsdelivr.net/gh/pointhi/leaflet-color-markers@master/img/marker-icon-yellow.png',
        shadowUrl: 'https://unpkg.com/leaflet@1.7.1/dist/images/marker-shadow.png',
        iconSize: [25, 41],
        iconAnchor: [12, 41],
        popupAnchor: [1, -34],
        shadowSize: [41, 41]
      }),
      Bahaya: new L.Icon({
        iconUrl: 'https://cdn.jsdelivr.net/gh/pointhi/leaflet-color-markers@master/img/marker-icon-red.png',
        shadowUrl: 'https://unpkg.com/leaflet@1.7.1/dist/images/marker-shadow.png',
        iconSize: [25, 41],
        iconAnchor: [12, 41],
        popupAnchor: [1, -34],
        shadowSize: [41, 41]
      })
    };



    // Smooth scroll for anchor links
    document.querySelectorAll('a[href^="#"]').forEach(anchor => {
      anchor.addEventListener('click', function (e) {
        e.preventDefault();
        const target = document.querySelector(this.getAttribute('href'));
        if (target) {
          target.scrollIntoView({ behavior: 'smooth', block: 'start' });
        }
      });
    });

    document.addEventListener("DOMContentLoaded", function () {
      document.querySelectorAll(".faq-question").forEach(btn => {
        btn.addEventListener("click", () => {
          const answer = btn.nextElementSibling;
          answer.style.display = answer.style.display === "block" ? "none" : "block";
        });
      });
    });

    // River Level Table
    const riverLevelTable = document.getElementById("riverLevelTable").getElementsByTagName("tbody")[0];
    hydroStations.forEach(station => {
      const row = riverLevelTable.insertRow();
      row.innerHTML = `
        <td>${station.name}</td>
        <td>${station.river_level} m</td>
        <td style="color:${station.river_status === 'Normal' ? '#28a745' : station.river_status === 'Amaran' ? '#ffc107' : '#dc3545'};">
          ${station.river_status}
        </td>
        <td>${station.last_update}</td>
      `;
    });

</script>

<script>
  document.addEventListener("DOMContentLoaded", function () {
    const toggleMapBtn = document.getElementById("toggleMap");
    const closeMapBtn = document.getElementById("closeMapBtn");
    const mapContainer = document.getElementById("mapContainer");

    // Show fullscreen map on mobile
    toggleMapBtn.addEventListener("click", function () {
      if (window.innerWidth <= 768) {
        mapContainer.style.display = "block";
        closeMapBtn.style.display = "block";
      }
    });

    // Close fullscreen map
    closeMapBtn.addEventListener("click", function () {
      mapContainer.style.display = "none";
      closeMapBtn.style.display = "none";
    });
  });
</script>

<script>
  document.addEventListener("DOMContentLoaded", function () {
    const contactBtn = document.getElementById("contact-btn");
    const contactModal = document.getElementById("contactModal");
    const closeContact = document.getElementById("closeContact");

    contactBtn.addEventListener("click", function () {
      contactModal.style.display = "block";
    });

    closeContact.addEventListener("click", function () {
      contactModal.style.display = "none";
    });

    window.addEventListener("click", function (event) {
      if (event.target === contactModal) {
        contactModal.style.display = "none";
      }
    });
  });
</script>


<!-- Contact Modal -->
<div id="contactModal" class="contact-modal">
  <div class="contact-modal-content">
    <span id="closeContact" class="close-contact">&times;</span>
    <h2>Hubungi Kami</h2>
    <p><strong>Alamat:</strong> Pejabat JPS Kuala Nerus, Terengganu</p>
    <p><strong>Telefon:</strong> 09-XXXXXXX</p>
    <p><strong>Email:</strong> <a href="mailto:info@jpskualanerus.gov.my">info@jpskualanerus.gov.my</a></p>
    <p><strong>Waktu Operasi:</strong> Ahad - Khamis, 8:00 pagi - 5:00 petang</p>
    
    <!-- Google Map Embed -->
    <div style="margin-top:15px;">
      <iframe 
        src="https://www.google.com/maps/embed?pb=!1m18!1m12!1m3!1d3972.1449186929967!2d103.06176819999999!3d5.394877500000001!2m3!1f0!2f0!3f0!3m2!1i1024!2i768!4f13.1!3m3!1m2!1s0x31b7bb0021b0d9c7%3A0xf67cef58701a3736!2sJPS%20Daerah%20Kuala%20Nerus!5e0!3m2!1sen!2smy!4v1754882888003!5m2!1sen!2smy" 
        width="100%" height="200" style="border:0;border-radius:8px;" referrerpolicy="no-referrer-when-downgrade" allowfullscreen="" loading="lazy"> 
      </iframe>
    </div>
  </div>
</div>

  <script>
  document.addEventListener("DOMContentLoaded", function () {
    const dropdowns = document.querySelectorAll(".dropdown");

    dropdowns.forEach(dropdown => {
      dropdown.querySelector("a").addEventListener("click", function (e) {
        if (window.innerWidth <= 900) { // Only run on mobile
          e.preventDefault(); // Prevent link navigation
          dropdown.classList.toggle("open");
        }
      });
    });

    // Language switcher
    const langBtns = document.querySelectorAll(".lang-btn");
    langBtns.forEach(btn => {
      btn.addEventListener("click", function () {
        const lang = this.dataset.lang;
        document.querySelectorAll("[data-lang-bm]").forEach(el => {
          el.textContent = el.getAttribute(`data-lang-${lang}`);
        });
      });
    });
  });
  </script>

<script>
  // Mobile menu toggle
  document.querySelector('.nav-toggle').addEventListener('click', () => {
    document.querySelector('.nav-menu').classList.toggle('open');
  });

  // Mobile dropdown toggle
  document.querySelectorAll('.dropdown > a').forEach(link => {
    link.addEventListener('click', e => {
      if (window.innerWidth <= 900) {
        e.preventDefault();
        link.parentElement.classList.toggle('open');
      }
    });
  });

  // Live Date-Time
  function updateDateTime() {
    const now = new Date();
    document.getElementById("date-time-text").textContent = 
      now.toLocaleDateString('ms-MY', { weekday: 'long', year: 'numeric', month: 'long', day: 'numeric' }) +
      ' | ' + now.toLocaleTimeString('ms-MY');
  }
  setInterval(updateDateTime, 1000);
  updateDateTime();
</script>

</body>
</html>