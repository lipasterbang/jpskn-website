<!DOCTYPE html>
<html lang="ms">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, viewport-fit=cover">
  <title>Jabatan Pengairan dan Saliran Kuala Nerus</title>
  <meta name="description" content="Laman Rasmi Jabatan Pengairan dan Saliran Daerah Kuala Nerus. Info banjir, peta interaktif, data hujan dan aras sungai, serta permohonan rasmi.">
  <meta name="keywords" content="JPS Kuala Nerus, Banjir Terengganu, Peta Interaktif, Data Hujan, OSC, Permohonan Sungai">
  <meta name="author" content="Jabatan Pengairan dan Saliran Daerah Kuala Nerus">
  <link rel="stylesheet" href="https://unpkg.com/leaflet@1.7.1/dist/leaflet.css">
  <link rel="stylesheet" href="https://unpkg.com/leaflet.markercluster/dist/MarkerCluster.css" />
  <link rel="stylesheet" href="https://unpkg.com/leaflet.markercluster/dist/MarkerCluster.Default.css" />
  <style>
    body {
      margin: 0;
      font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
      background-color: #f9f9f9;
      color: #333;
    }

    header {
      background-color: #005bb5;
      color: white;
      padding: 2rem 1rem 1.2rem 1rem;
      text-align: center;
      box-shadow: 0 2px 8px rgba(0,0,0,0.04);
    }

    .logo-container {
      display: flex;
      justify-content: center;
      align-items: center;
      gap: 2rem;
      margin-bottom: 1rem;
      flex-wrap: wrap;
    }
    .logo-container img {
      max-height: 70px;
      height: 10vw;
      min-height: 48px;
      width: auto;
      object-fit: contain;

      border-radius: 8px;
      padding: 4px 8px;
      box-shadow: 0 2px 8px rgba(0,0,0,0.06);
    }

    .main-title {
      font-size: 2.1rem;
      font-weight: 700;
      letter-spacing: 1px;
      margin: 0;
      color: #fff;
      text-shadow: 0 2px 8px rgba(0,0,0,0.08);
    }

    nav {
      background-color: #0073e6;
      display: flex;
      flex-wrap: wrap;
      justify-content: center;
      padding: 0.8rem 1rem;
      position: sticky;
      top: 0;
      z-index: 999;
      box-shadow: 0 2px 8px rgba(0,0,0,0.04);
    }

    nav a {
      color: white;
      margin: 0 1rem;
      text-decoration: none;
      font-weight: bold;
      font-size: 1.05rem;
      transition: color 0.2s;
      padding: 0.3rem 0.7rem;
      border-radius: 4px;
    }

    nav a:hover, nav a:focus {
      background: #005fa3;
      color: #ffd700;
      outline: none;
    }

    .container {
      margin:0 auto;
      padding: 0 1rem;
    }

    section {
      background-color: white;
      padding: 2rem;
      border-radius: 10px;
      box-shadow: 0 4px 12px rgba(0, 0, 0, 0.05);
      margin-bottom: 2rem;
    }

    h2 {
      color: #004d99;
      margin-top: 0;
    }

    #map {
      height: 400px;
      border-radius: 10px;
      margin-top: 1rem;
      width: 100%;
    }

    .grid {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
      gap: 20px;
    }
    #documents ul {
      list-style: none;
      padding-left: 0;
    }
    #documents ul li {
      font-size: 16px;
      margin: 0.5rem 0;
    }
    #documents ul li a {
      color: #0073e6;
      text-decoration: none;
      font-weight: bold;
    }
    #documents ul li a:hover {
      text-decoration: underline;
    }
    #documents ul li::before {
      content: "ğŸ“¥ ";
      margin-right: 6px;
    }

    .main-nav {
  background: #0073e6;
  box-shadow: 0 2px 8px rgba(0,0,0,0.04);
  position: sticky;
  top: 0;
  z-index: 999;
}
.nav-menu {
  display: flex;
  flex-wrap: wrap;
  justify-content: center;
  align-items: center;
  gap: 0.2rem;
  padding: 0;
  margin: 0;
  background: #0073e6;
}
.nav-menu > li {
  position: relative;
}
.nav-menu > li > a {
  color: white;
  margin: 0 0.5rem;
  text-decoration: none;
  font-weight: bold;
  font-size: 1.08rem;
  padding: 0.5rem 1.2rem;
  border-radius: 6px;
  display: block;
  transition: background 0.2s, color 0.2s;
}
.nav-menu > li > a:hover,
.nav-menu > li > a:focus {
  background: #005fa3;
  color: #ffd700;
  outline: none;
}
.dropdown-content {
  display: none;
  position: absolute;
  background: #fff;
  min-width: 220px;
  box-shadow: 0 8px 16px rgba(0,0,0,0.08);
  z-index: 1000;
  left: 0;
  top: 100%;
  border-radius: 0 0 8px 8px;
  padding: 0.5rem 0;
}
.dropdown-content li {
  width: 100%;
}
.dropdown-content li a {
  color: #004d99;
  padding: 0.7rem 1.2rem;
  text-decoration: none;
  display: block;
  font-weight: normal;
  font-size: 1rem;
  border-radius: 0;
  transition: background 0.2s, color 0.2s;
}
.dropdown-content li a:hover {
  background: #f0f6ff;
  color: #0073e6;
}
.dropdown:hover .dropdown-content,
.dropdown:focus-within .dropdown-content {
  display: block;
}
.nav-toggle {
  display: none;
}
@media (max-width: 900px) {
  .nav-toggle {
    display: block !important;
  }
  .nav-menu {
    flex-direction: column;
    align-items: stretch;
    width: 100%;
    background: #0073e6;
    position: absolute;
    left: 0;
    top: 60px;
    z-index: 1000;
    display: none;
  }
  .nav-menu.open {
    display: flex;
  }
  .nav-menu > li {
    width: 100%;
  }
  .nav-menu > li > a {
    margin: 0;
    padding: 1rem;
    font-size: 1.05rem;
    border-radius: 0;
    border-bottom: 1px solid #005fa3;
  }
  .dropdown-content {
    position: static;
    box-shadow: none;
    min-width: 100%;
    border-radius: 0;
    padding: 0;
  }
  .dropdown-content li a {
    padding-left: 2rem;
    font-size: 0.98rem;
  }
}
    .responsive-table {
    display: block;
    width: 100%;
    overflow-x: auto;
    -webkit-overflow-scrolling: touch;
  }
  .responsive-table table {
    width: 700px; /* or min-width: 600px; */
  }

    #backToTop {
      position: fixed;
      bottom: 30px;
      right: 30px;
      z-index: 999;
      background-color: #0073e6;
      color: white;
      border: none;
      padding: 0.8rem 1rem;
      border-radius: 50%;
      font-size: 1.2rem;
      box-shadow: 0 6px 16px rgba(0, 0, 0, 0.2);
      cursor: pointer;
      display: none;
    }

    #help-button {
      position: fixed;
      bottom: 30px;
      left: 30px;
      background-color: #28a745;
      color: white;
      padding: 12px 16px;
      border-radius: 30px;
      box-shadow: 0 4px 10px rgba(0, 0, 0, 0.2);
      cursor: pointer;
      font-weight: bold;
      z-index: 1000;
    }

    #mapContainer {
      display: block;
    }

    #rainfallTable {
      width: 100%;
      border-collapse: collapse;
    }
    #rainfallTable th, #rainfallTable td {
      padding: 0.8rem;
      border: 1px solid #ccc;
    }
    #rainfallTable th {
      background-color: #0073e6;
      color: white;
    }

    /* Responsive adjustments */
    @media (max-width: 700px) {
      header {
        padding: 1.2rem 0.5rem 0.8rem 0.5rem;
      }
      .main-title {
        font-size: 1.2rem;
      }
      .logo-container {
        gap: 1rem;
      }
      section {
        padding: 1rem;
      }
      nav a {
        margin: 0 0.4rem;
        font-size: 0.98rem;
      }
    }

      /* Hamburger button visible on mobile */
    @media (max-width: 900px) {
    .nav-toggle {
      display: block !important;
    }
    .nav-menu {
      display: none;
      flex-direction: column;
      align-items: stretch;
      width: 100%;
      background: #0073e6;
      position: absolute;
      left: 0;
      top: 60px;
      z-index: 1000;
    }
    .nav-menu.open {
      display: flex;
    }
    .nav-menu > li {
      width: 100%;
    }
    .nav-menu > li > a {
      margin: 0;
      padding: 1rem;
      font-size: 1.05rem;
      border-radius: 0;
      border-bottom: 1px solid #005fa3;
    }
    .dropdown-content {
      position: static;
      box-shadow: none;
      min-width: 100%;
      border-radius: 0;
      padding: 0;
    }
    .dropdown-content li a {
      padding-left: 2rem;
      font-size: 0.98rem;
    }
  }

    footer {
      background-color: #004d99;
      color: #fff;
      text-align: center;
      padding: 2rem 1rem 0.8rem 1rem;
      font-size: 1rem;
      margin-top: 3rem;
      border-top: 4px solid #0073e6;
      letter-spacing: 0.5px;
    }
    footer a {
      color: #ffd700;
      text-decoration: underline;
    }
    footer a:hover {
      color: #fff;
    }

    .search-bar {
      display: flex;
      justify-content: center;
      margin: 1.5rem 0;
    }
    .search-bar input[type="search"] {
      width: 100%;
      max-width: 340px;
      padding: 0.7rem 1.2rem;
      border-radius: 24px;
      border: 1px solid #ccc;
      font-size: 1rem;
      transition: box-shadow 0.2s;
    }
    .search-bar input[type="search"]:focus {
      outline: none;
      box-shadow: 0 0 0 2px #0073e6;
      border-color: #0073e6;
    }
    @media (max-width: 700px) {
      .search-bar {
        margin: 1rem 0;
      }
      .search-bar input[type="search"] {
        font-size: 0.98rem;
        padding: 0.6rem 1rem;
      }
    }
    .responsive-table {
      width: 100%;
      overflow-x: auto;
    }
    @media (max-width: 700px) {
      .responsive-table table {
        min-width: 500px;
        font-size: 0.98rem;
      }
      #hydrology-data h2 {
        font-size: 1.1rem;
      }
      #hydrology-data .map-toggle-btn {
        font-size: 0.98rem;
        padding: 0.5rem 1rem;
      }
    }
    
    #riverLevelTable th, #riverLevelTable td {
      padding: 0.8rem;
      border: 1px solid #e0e0e0;
      text-align: center;
    }
    #riverLevelTable th {
      background-color: #0073e6;
      color: white;
      font-size: 1.05em;
      letter-spacing: 0.5px;
    }
    #riverLevelTable td {
      font-size: 1em;
      background: #fff;
    }
    #riverLevelTable tr:nth-child(even) td {
      background: #f6faff;
    }
    @media (max-width: 700px) {
      #riverLevelTable, #riverLevelTable thead, #riverLevelTable tbody, #riverLevelTable tr, #riverLevelTable th, #riverLevelTable td {
        display: block;
        width: 100%;
      }
      #riverLevelTable thead {
        display: none;
      }
      #riverLevelTable tr {
        margin-bottom: 1.2em;
        border-bottom: 2px solid #0073e6;
        border-radius: 8px;
        background: #fff;
        box-shadow: 0 2px 8px rgba(0,0,0,0.04);
      }
      #riverLevelTable td {
        text-align: left;
        padding: 0.7em 1em;
        position: relative;
        border: none;
        font-size: 1em;
      }
      #riverLevelTable td:before {
        content: attr(data-label);
        font-weight: bold;
        color: #004d99;
        display: block;
        margin-bottom: 0.2em;
      }
    }
    .responsive-form-iframe {
      width: 100%;
      max-width: 700px;
      margin: 0 auto 2rem auto;
    }
    .responsive-form-iframe iframe {
      width: 100%;
      min-height: 600px;
      max-height: 1200px;
      border: none;
      background: #fff;
      display: block;
    }
    @media (max-width: 700px) {
      .responsive-form-iframe iframe {
        min-height: 520px;
        height: 80vh;
        max-height: 1000px;
      }
    }
    .dashboard-grid {
      display: flex;
      flex-wrap: wrap;
      gap: 1.2rem;
      justify-content: space-between;
    }
    .dashboard-card {
      flex: 1 1 180px;
      min-width: 160px;
      background: #f8fbff;
      border-radius: 12px;
      box-shadow: 0 2px 8px rgba(0,0,0,0.06);
      padding: 1.2rem 1rem 1rem 1rem;
      display: flex;
      flex-direction: column;
      align-items: flex-start;
      min-height: 110px;
    }
    .dashboard-title {
      font-size: 1.05em;
      color: #004d99;
      font-weight: 600;
      margin-bottom: 0.5em;
    }
    .dashboard-value {
      font-size: 1.7em;
      font-weight: bold;
      color: #0073e6;
      margin-bottom: 0.2em;
      line-height: 1.1;
    }
    .dashboard-label {
      font-size: 0.98em;
      color: #666;
    }
    @media (max-width: 900px) {
      .dashboard-grid {
        gap: 0.8rem;
      }
      .dashboard-card {
        min-width: 140px;
        padding: 1rem 0.7rem 0.8rem 0.7rem;
      }
    }
    @media (max-width: 700px) {
      .dashboard-grid {
        flex-direction: column;
        gap: 1rem;
      }
      .dashboard-card {
        width: 100%;
        min-width: 0;
        align-items: flex-start;
      }
    }

    #live-date-time {
      width: 100%;
      background: #003366;
      color: #fff;
      text-align: center;
      font-size: 1.05rem;
      font-weight: 500;
      letter-spacing: 0.5px;
      padding: 0.3rem 0;
      position: relative;
      z-index: 1001;
      display: flex;
      align-items: center;
      justify-content: center;
      gap: 1.2rem;
      flex-wrap: wrap;
    }
    #live-date-time span {
      flex: 1 1 auto;
      text-align: center;
    }
    #live-date-time button {
      background: none;
      border: none;
      color: #ffd700;
      font-size: 1.3em;
      cursor: pointer;
      margin: 0 0.2em;
    }
    #live-date-time form {
      display: inline-block;
      margin: 0 0.2em;
    }
    #live-date-time input[type="search"] {
      padding: 0.3em 0.9em;
      border-radius: 16px;
      border: none;
      font-size: 1em;
      width: 120px;
      max-width: 40vw;
    }
    #live-date-time button[type="submit"] {
      background: #ffd700;
      border: none;
      color: #003366;
      font-weight: bold;
      border-radius: 16px;
      padding: 0.3em 0.9em;
      margin-left: 0.2em;
      cursor: pointer;
    }
    #faq-btn, #contact-btn, #feedback-btn {
      font-size: 1.3em;
      cursor: pointer;
      color: #ffd700;
      margin: 0 0.2em;
    }
  </style>
</head>

<body>

  <!-- Live Date/Time Display with logo buttons and search -->
  <div id="live-date-time"
  style="width:100%;background:#003366;color:#fff;text-align:center;font-size:1.05rem;font-weight:500;letter-spacing:0.5px;padding:0.3rem 0;position:relative;z-index:1001;display:flex;align-items:center;justify-content:center;gap:1.2rem;flex-wrap:wrap;">
  <span id="date-time-text" style="flex:1 1 auto;text-align:center;"></span>
  <button id="faq-btn" title="Soalan Lazim" style="background:none;border:none;color:#ffd700;font-size:1.3em;cursor:pointer;margin:0 0.2em;">
    <span aria-label="FAQ" role="img">â“</span>
  </button>
  <button id="contact-btn" title="Hubungi Kami" style="background:none;border:none;color:#ffd700;font-size:1.3em;cursor:pointer;margin:0 0.2em;">
    <span aria-label="Contact" role="img">ğŸ“</span>
  </button>
  <button id="feedback-btn" title="Maklum Balas" style="background:none;border:none;color:#ffd700;font-size:1.3em;cursor:pointer;margin:0 0.2em;">
    <span aria-label="Maklum Balas" role="img">ğŸ’¬</span>
  </button>
  <form id="header-search-form" style="display:inline-block;margin:0 0.2em;">
    <input id="header-search-input" type="search" placeholder="Cari..." style="padding:0.3em 0.9em;border-radius:16px;border:none;font-size:1em;width:120px;max-width:40vw;">
    <button type="submit" style="background:#ffd700;border:none;color:#003366;font-weight:bold;border-radius:16px;padding:0.3em 0.9em;margin-left:0.2em;cursor:pointer;">Cari</button>
  </form>
</div>

  <!-- Header with Logos -->
  <header style="cursor:pointer;" onclick="window.location.href='index.html'">
    <div class="logo-container">
      <img src="jpslogo.png" alt="Logo JPS Kuala Nerus" style="cursor:pointer;">
      <img src="trglogo.png" alt="Logo SUK Terengganu" style="cursor:pointer;">
    </div>
    <h1 class="main-title" style="cursor:pointer;">JABATAN PENGAIRAN DAN SALIRAN DAERAH KUALA NERUS</h1>
  </header>

  <!-- Add this just before your <nav> ... </nav> -->
  <button class="nav-toggle" aria-label="Menu" style="display:none;position:absolute;right:1rem;top:1.1rem;background:none;border:none;font-size:2rem;color:#fff;z-index:1001;cursor:pointer;">&#9776;</button>

  <nav style="position:relative;">
    <ul class="nav-menu">
      <li class="dropdown">
        <a href="#about">Profil</a>
        <ul class="dropdown-content">
          <li><a href="#pengenalan">Pengenalan</a></li>
          <li><a href="#kata-aluan">Kata Aluan Jurutera Daerah</a></li>
          <li><a href="#visi-misi">Visi Misi Objektif</a></li>
          <li><a href="#carta-organisasi">Carta Organisasi</a></li>
        </ul>
      </li>
      <li class="dropdown">
        <a href="#services">Perkhidmatan</a>
        <ul class="dropdown-content">
          <li><a href="#ruangan-iklan">Ruangan Iklan</a></li>
          <li><a href="#ruangan-tender">Sebut Harga/Tender</a></li>
          <li><a href="#news-section">Berita</a></li>
          <li><a href="#laporan-osc">Laporan OSC</a></li>
        </ul>
      </li>
      <li class="dropdown">
        <a href="#map-section">Peta</a>
      </li>
      <li class="dropdown">
        <a href="#hydrology-data">Taburan Hujan</a>
      </li>
      <li class="dropdown">
        <a href="#repositori-dokumen">Dokumen</a>
      </li>
      <li class="dropdown">
        <a href="#contact">Hubungi</a>
      </li>
      <li class="dropdown">
        <a href="#">Info Banjir</a>
        <ul class="dropdown-content">
          <li>
            <a href="https://publicinfobanjir.water.gov.my/aras-air/data-paras-air/?state=TRG&lang=en" target="_blank" rel="noopener">
              Info Aras Air
            </a>
          </li>
          <li>
            <a href="https://publicinfobanjir.water.gov.my/hujan/data-hujan/?state=TRG&lang=en" target="_blank" rel="noopener">
              Info Hujan Lebat
            </a>
          </li>
          <li>
            <a href="https://jpsweb.terengganu.gov.my/index.php/ms/info-banjir/siren-amaran-banjir" target="_blank" rel="noopener">
              Siren Amaran Banjir
            </a>
          </li>
          <li>
            <a href="https://jpsweb.terengganu.gov.my/index.php/ms/info-banjir/stesen-lebat-hujan" target="_blank" rel="noopener">
              Stesen Lebat Hujan
            </a>
          </li>
          <li>
            <a href="https://jpsweb.terengganu.gov.my/index.php/ms/info-banjir/stesen-paras-air-sungai" target="_blank" rel="noopener">
              Stesen Paras Air Sungai
            </a>
          </li>
        </ul>
      </li>
    </ul>
  </nav>

  <div class="container">

    <section id="about" class="section">
      <h2>Profil Kami</h2>
  
    <p>Selamat datang ke laman web rasmi Jabatan Pengairan dan Saliran Daerah Kuala Nerus. </p>
      <p>"Jayakan Perkhidmatan Sempurna".</p>
    

    <!-- Pengenalan -->
    <section id="pengenalan" style="margin-top:2rem;">
        <h1>Pengenalan Jabatan Pengairan dan Saliran Daerah Kuala Nerus</h1>

  <p>
    Jabatan Pengairan dan Saliran (JPS) Daerah Kuala Nerus merupakan salah satu pejabat daerah di bawah pentadbiran 
    Jabatan Pengairan dan Saliran Negeri Terengganu, yang memainkan peranan penting dalam pengurusan sumber air, 
    sistem saliran bandar, tebatan banjir, serta pembangunan dan penyelenggaraan infrastruktur saliran di seluruh kawasan Kuala Nerus.
    Sebagai cabang pentadbiran yang beroperasi di peringkat daerah, JPS Kuala Nerus terdiri daripada Jurutera Daerah (J10), Penolong Jurutera Kanan (JA7), 4 Penolong Jurutera (JA5), Pelukis Pelan (JA1), Pembantu Tadbir (N1), Pembantu Tadbir Kewangan (W1) dan juga 11 Pembantu Khidmat Am (H1).
  </p>

  <p>
    Jabatan Pengairan dan Saliran Negeri Terengganu telah ditubuhkan pada tahun 1957, dan dahulunya dikenali sebagai 
    Jabatan Parit dan Taliair, ditadbir oleh Jurutera Parit dan Taliair Terengganu/Kelantan. Bermula sebagai sebuah organisasi kecil 
    dengan kurang daripada 100 orang kakitangan, kini JPS Negeri Terengganu berkembang pesat dengan lebih 500 orang pegawai dan kakitangan. 
    Ibu pejabatnya terletak di Tingkat 6, Wisma Negeri, Kuala Terengganu, dan dibantu oleh pejabat JPS di daerah-daerah termasuk JPS Daerah Kuala Nerus, 
    serta JPS Projek KETARA di Besut.
  </p>

  <p>
    Di peringkat negeri, terdapat enam bahagian utama yang menyokong pengurusan tertinggi, iaitu:
  </p>

  <ul>
    <li>Bahagian Pengairan dan Saliran</li>
    <li>Bahagian Kejuruteraan Sungai dan Pantai</li>
    <li>Bahagian Hidrologi</li>
    <li>Bahagian Khidmat Teknikal</li>
    <li>Bahagian Pentadbiran dan Kewangan</li>
    <li>Bahagian Perkhidmatan Mekanikal (beroperasi di Jalan Bukit Kecil, Kuala Terengganu)</li>
  </ul>

  <p>
    Sebagai sebahagian daripada rangkaian teknikal ini, JPS Kuala Nerus berperanan memastikan perkhidmatan berkaitan pengurusan air dan saliran 
    dilaksanakan secara efisien, berdaya saing dan mampan. Kami komited untuk memberikan perkhidmatan terbaik kepada masyarakat 
    melalui kerjasama dengan agensi teknikal, pihak berkuasa tempatan, dan komuniti setempat demi kelestarian alam dan kesejahteraan rakyat.
  </p>
      </p>
    </section>

    <!-- Kata Aluan Jurutera Daerah -->
    <section id="kata-aluan" style="margin-top:2rem;">
      <h3>Kata Aluan Jurutera Daerah</h3>
      <blockquote style="border-left:4px solid #0073e6;padding-left:1rem;color:#004d99;background:#f6faff;">
        <!-- Sila isikan kata aluan di sini. Contoh: -->
        "Selamat datang ke laman web rasmi JPS Kuala Nerus. Kami sentiasa komited dalam memberikan perkhidmatan terbaik kepada masyarakat serta memastikan pengurusan air dan saliran yang mampan untuk masa depan yang lebih sejahtera."
        <br><br>
        <span style="font-weight:bold;">Jurutera Daerah<br>JPS Kuala Nerus</span>
      </blockquote>
    </section>

    <!-- Visi Misi Objektif -->
    <section id="visi-misi" style="margin-top:2rem;">
      <h3>Visi, Misi & Objektif</h3>
      <ul>
        <li><strong>Visi:</strong> Menjadi organisasi sektor awam antara yang unggul di dunia.</li>
        <li><strong>Misi:</strong> Menguruskan sumber air, lembangan sungai, risiko banjir dan zon pinggir laut untuk mencapai alam sekitar yang mapan dan kualiti hidup yang dipertingkatkan.</li>
        <li><strong>Objektif:</strong> Menyediakan perkhidmatan kejuruteraan yang melebihi keupayaan kumpulan sasaran sendiri seterusnya menjamin penggunaan tanah yang optimum dan pengurusan yang lebih cekap bagi sumber air negara.</li>
        <li><strong>Fungsi Utama JPS:</strong>
          <ul>
            <li><b>Pengairan Dan Saliran Pertanian :</b> Membangun, mengendali dan menyelenggara kemudahan-kemudahan pengairan, saliran dan tebatan banjir serta menjalankan kerja pemeliharaan sungai bagi mendokong pembangunan dan kemajuan sektor pertanian, khususnya bagi faedah sektor pekebun-pekebun dan petani-petani kecil.</li>
            <li><b>Saliran Dan Tebatan Banjir :</b> Mengkaji, merancang dan melaksanakan kerja-kerja tebatan banjir di kawasan bandar bagi mengurangkan kejadian banjir yang berlaku di negeri ini bagi menjamin kesejahteraan hidup penduduk dan mengurangkan kerosakan harta benda.</li>
            <li><b>Kejuruteraan Sungai :</b> Mengkaji, merancang dan melaksanakan program pemeliharaan dan pemuliharaan sungai-sungai di Negeri Terengganu bagi penduduk-penduduk luar bandar dan bandar dengan melindungi nyawa, harta benda dan kawasan-kawasan pertanian serta menyediakan kemudahan rekreasi di sepanjang koridor sungai.</li>
            <li><b>Kejuruteraan Pantai :</b> Memungut data-data mengenai kejuruteraan pantai untuk mengesan hakisan dan bagi kegunaan pelbagai jabatan dan agensi kerajaan dalam perancangan dan rekabentuk projek-projek spesifik dan untuk tujuan penyelidikan. Menjalankan kerja-kerja mengawal dan mencegah hakisan pantai.</li>
            <li><b>Hidrologi Dan Sumber Air :</b> Mengumpul data hidrologi diseluruh negeri bagi memenuhi keperluan pembangunan dan pengurusan sumber air yang dikendalikan oleh pelbagai jabatan dan agensi kerajaan.</li>
            <li><b>Khidmat Nasihat Dan Sokongan :</b> Memberi ulasan terhadap permohonan pembangunan perumahan, menukar syarat kegunaan tanah, mengeluarkan tanah bukit dan perkara-perkara lain yang terlibat dengan Enakmen Air. Melaksanakan kerja-kerja kejuruteraan awam / bangunan untuk agensi lain di bawah Kementerian.</li>
          </ul>
        </li>
      </ul>
    </section>

    <section id="carta-organisasi" style="margin-top:2rem;">
    <h3>Carta Organisasi</h3>
    <div style="text-align:center;">
      <img src="carta-organisasi-2025.png" alt="Carta Organisasi JPS Kuala Nerus 2025" style="max-width:100%;height:auto;border-radius:10px;box-shadow:0 2px 8px rgba(0,0,0,0.08);margin-bottom:1rem;">
    </div>
    <p style="text-align:center;font-size:0.95em;color:#666;margin-top:0.5rem;">
      (Klik kanan dan 'Save Image As...' untuk muat turun carta atau <a href="CARTA ORGANISASI JPS KUALA NERUS 2025.pdf" target="_blank">muat turun PDF</a>)
    </p>
  </section>

  <!-- Add this inside your #services section, after the existing content or news section -->
<section id="laporan-osc" class="section" style="margin-top:2rem;">
  <h3>ğŸ“‘ Laporan Ulasan OSC</h3>
  <p>
    Senarai laporan ulasan rasmi oleh JPS Kuala Nerus yang disediakan melalui sistem OSC bagi projek pembangunan dan teknikal.
    Pengguna boleh memuat turun surat ulasan teknikal untuk rujukan dan tindakan lanjut.
  </p>
  <div class="grid">
    <!-- Contoh Laporan 1 -->
    <article>
      <h3>Projek Perumahan Bukit Tok Beng</h3>
      <ul>
        <li>ğŸ“¥ <a href="documents/osc/bukit-tok-beng-ulasan.pdf" download>Ulasan Teknikal JPS (PDF)</a></li>
        <li>ğŸ—“ï¸ Tarikh Ulasan: 05 Mei 2025</li>
      </ul>
    </article>
    <!-- Contoh Laporan 2 -->
    <article>
      <h3>Pembinaan Dewan Orang Ramai Batu Rakit</h3>
      <ul>
        <li>ğŸ“¥ <a href="documents/osc/dewan-batu-rakit-ulasan.pdf" download>Ulasan Teknikal JPS (PDF)</a></li>
        <li>ğŸ—“ï¸ Tarikh Ulasan: 22 April 2025</li>
      </ul>
    </article>
    <!-- Tambah lebih banyak laporan di sini -->
  </div>
</section>

  <!-- Ruangan Iklan -->
  <section id="ruangan-iklan" style="margin-top:2rem;">
    <h3>ğŸ“¢ Ruangan Iklan</h3>
    <div style="background:#f8fbff;border-radius:8px;padding:1rem 1.5rem;box-shadow:0 2px 8px rgba(0,0,0,0.04);margin-bottom:1rem;">
      <!-- Sila masukkan maklumat iklan di sini -->
      <p><strong>Tiada iklan terkini.</strong> Sila semak semula dari semasa ke semasa untuk makluman terbaru.</p>
    </div>
  </section>

  <!-- Ruangan Sebut Harga/Tender -->
  <section id="ruangan-tender" style="margin-top:2rem;">
    <h3>ğŸ“‘ Ruangan Sebut Harga / Tender</h3>
    <div style="background:#f8fbff;border-radius:8px;padding:1rem 1.5rem;box-shadow:0 2px 8px rgba(0,0,0,0.04);">
      <!-- Sila masukkan maklumat tender di sini -->
      <p><strong>Tiada sebut harga atau tender dibuka buat masa ini.</strong></p>
      <ul>
        <!-- Contoh item tender -->
        <!-- <li><a href="documents/tender-2025-01.pdf" target="_blank">Tender Projek Tebatan Banjir 2025</a> (Tutup: 30 Jun 2025)</li> -->
      </ul>
    </div>
  </section>

  <!-- Berita Terkini -->
  <section id="news-section" class="section" style="margin-top:2rem;">
  <h3>ğŸ“° Berita Terkini</h3>
  <div class="news-list" style="display: flex; flex-direction: column; gap: 1.5rem;">
    <!-- News Item 1 -->
    <article class="news-item" style="background:#f8fbff;border-radius:8px;box-shadow:0 2px 8px rgba(0,0,0,0.04);padding:1rem 1.5rem;display:flex;flex-wrap:wrap;align-items:flex-start;gap:1rem;">
      <img src="images/news/petra.jpg" alt="Skuad PETRA Menyelami Isu Hakisan Pantai Kuala Nerus" style="width:120px;max-width:100%;border-radius:8px;object-fit:cover;">
      <div style="flex:1;">
        <h4 style="margin:0 0 0.5rem 0;font-size:1.1rem;color:#004d99;">Skuad PETRA Menyelami Isu Hakisan Pantai Kuala Nerus, Terengganu</h4>
        <div style="font-size:0.95em;color:#888;margin-bottom:0.5rem;">14 Mei 2024</div>
        <p style="margin:0 0 0.5rem 0;">
          Skuad PETRA telah turun padang bagi meneliti isu hakisan pantai yang semakin membimbangkan di Kuala Nerus, Terengganu. Lawatan ini bertujuan untuk mendapatkan maklumat terkini serta mencari penyelesaian jangka panjang bersama pihak berkaitan.
        </p>
        <a href="https://jpsweb.terengganu.gov.my/index.php/ms/arkib/berita/355-skuad-petra-menyelami-isu-hakisan-pantai-kuala-nerus-terengganu" target="_blank" style="color:#0073e6;font-weight:bold;text-decoration:underline;">Baca Selanjutnya</a>
      </div>
    </article>
    <!-- News Item 2 -->
    <article class="news-item" style="background:#f8fbff;border-radius:8px;box-shadow:0 2px 8px rgba(0,0,0,0.04);padding:1rem 1.5rem;display:flex;flex-wrap:wrap;align-items:flex-start;gap:1rem;">
      <img src="images/news/lawatan-dytm.jpg" alt="Lawatan Kerja Duli Yang Teramat Mulia Yang di-Pertuan Muda Terengganu ke Tapak Hakisan Pantai" style="width:120px;max-width:100%;border-radius:8px;object-fit:cover;">
      <div style="flex:1;">
        <h4 style="margin:0 0 0.5rem 0;font-size:1.1rem;color:#004d99;">Lawatan Kerja Duli Yang Teramat Mulia Yang di-Pertuan Muda Terengganu ke Tapak Hakisan Pantai</h4>
        <div style="font-size:0.95em;color:#888;margin-bottom:0.5rem;">7 Mei 2024</div>
        <p style="margin:0 0 0.5rem 0;">
          Duli Yang Teramat Mulia Yang di-Pertuan Muda Terengganu telah mengadakan lawatan kerja ke tapak hakisan pantai di Kuala Nerus bagi meninjau keadaan semasa dan mendapatkan taklimat daripada pihak JPS serta agensi berkaitan.
        </p>
        <a href="https://jpsweb.terengganu.gov.my/index.php/ms/arkib/berita/348-lawatan-kerja-duli-yang-teramat-mulia-yang-di-pertuan-muda-terengganu-ke-tapak-hakisan-pantai" target="_blank" style="color:#0073e6;font-weight:bold;text-decoration:underline;">Baca Selanjutnya</a>
      </div>
    </article>
    <!-- Tambah berita lain di sini -->
  </div>
</section>
</section>

    <!-- Interactive Map Section -->
<section id="map-section" class="section">
  <h2>ğŸ—ºï¸ Peta Interaktif JPS Kuala Nerus</h2>
  <button id="toggleMap" class="map-toggle-btn">Sembunyikan Peta</button>
  <div id="mapContainer" style="position:relative;">
    <div id="map" style="height:400px;border-radius:10px;margin-top:1rem;width:100%;"></div>
    <!-- Map Legend -->
    <div id="map-legend" style="background:rgba(255,255,255,0.98);border-radius:10px;box-shadow:0 2px 8px rgba(0,0,0,0.10);padding:14px 20px;position:absolute;bottom:20px;right:20px;z-index:1001;min-width:180px;font-size:1em;">
      <div style="font-weight:bold;color:#004d99;margin-bottom:0.5em;">Legenda Peta JPS</div>
      <div style="display:flex;align-items:center;margin-bottom:6px;">
        <img src="https://cdn.jsdelivr.net/gh/pointhi/leaflet-color-markers@master/img/marker-icon-blue.png" style="width:20px;height:32px;margin-right:8px;" alt="Pejabat JPS">
        <span>Pejabat JPS</span>
      </div>
      <div style="display:flex;align-items:center;margin-bottom:6px;">
        <img src="https://cdn.jsdelivr.net/gh/pointhi/leaflet-color-markers@master/img/marker-icon-red.png" style="width:20px;height:32px;margin-right:8px;" alt="Siren Banjir">
        <span>Siren Banjir</span>
      </div>
      <div style="display:flex;align-items:center;margin-bottom:6px;">
        <img src="https://cdn.jsdelivr.net/gh/pointhi/leaflet-color-markers@master/img/marker-icon-green.png" style="width:20px;height:32px;margin-right:8px;" alt="Stesen Hujan">
        <span>Stesen Hujan</span>
      </div>
      <div style="display:flex;align-items:center;margin-bottom:6px;">
        <img src="https://cdn.jsdelivr.net/gh/pointhi/leaflet-color-markers@master/img/marker-icon-yellow.png" style="width:20px;height:32px;margin-right:8px;" alt="Stesen Aras Air">
        <span>Stesen Aras Air</span>
      </div>
      <div style="display:flex;align-items:center;">
        <img src="https://cdn.jsdelivr.net/gh/pointhi/leaflet-color-markers@master/img/marker-icon-violet.png" style="width:20px;height:32px;margin-right:8px;" alt="Projek Tebatan Banjir">
        <span>Projek Tebatan Banjir</span>
      </div>
      <div style="border-top:1px solid #e0e0e0;margin:10px 0 0 0;padding-top:7px;font-size:0.93em;color:#666;">
        <span style="font-style:italic;">Klik ikon untuk maklumat lanjut.</span>
      </div>
    </div>
  </div>
  <p style="font-size:0.9em;color:#666;margin-top:0.5rem;text-align:center;">
    Peta ini menunjukkan lokasi pejabat JPS, stesen hujan, siren banjir, dan projek tebatan banjir di sekitar Kuala Nerus.
    Klik pada ikon untuk maklumat lanjut.
  </p>
</section>


<!-- Leaflet.js CDN (if not already included) -->
<script src="https://unpkg.com/leaflet/dist/leaflet.js"></script>
<script>
document.addEventListener("DOMContentLoaded", function () {
  // MAP SECTION
  const mapContainer = document.getElementById("mapContainer");
  const toggleMapBtn = document.getElementById("toggleMap");
  let mapInitialized = false;
  let map;

  function initMap() {
    if (mapInitialized) return;
    map = L.map("map").setView([5.39448, 103.06308], 12);
    window.map = map; // <-- Make map global for cluster logic

    L.tileLayer("https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png", {
      attribution: '&copy; OpenStreetMap contributors'
    }).addTo(map);

    // Custom icons
    const pejabatIcon = new L.Icon({
      iconUrl: 'https://cdn.jsdelivr.net/gh/pointhi/leaflet-color-markers@master/img/marker-icon-blue.png',
      shadowUrl: 'https://unpkg.com/leaflet@1.7.1/dist/images/marker-shadow.png',
      iconSize: [25, 41],
      iconAnchor: [12, 41],
      popupAnchor: [1, -34],
      shadowSize: [41, 41]
    });
    const floodSirenIcon = new L.Icon({
      iconUrl: 'https://cdn.jsdelivr.net/gh/pointhi/leaflet-color-markers@master/img/marker-icon-red.png',
      shadowUrl: 'https://unpkg.com/leaflet@1.7.1/dist/images/marker-shadow.png',
      iconSize: [25, 41],
      iconAnchor: [12, 41],
      popupAnchor: [1, -34],
      shadowSize: [41, 41]
    });
    const rainStationIcon = new L.Icon({
      iconUrl: 'https://cdn.jsdelivr.net/gh/pointhi/leaflet-color-markers@master/img/marker-icon-green.png',
      shadowUrl: 'https://unpkg.com/leaflet@1.7.1/dist/images/marker-shadow.png',
      iconSize: [25, 41],
      iconAnchor: [12, 41],
      popupAnchor: [1, -34],
      shadowSize: [41, 41]
    });
    const riverLevelIcon = new L.Icon({
      iconUrl: 'https://cdn.jsdelivr.net/gh/pointhi/leaflet-color-markers@master/img/marker-icon-yellow.png',
      shadowUrl: 'https://unpkg.com/leaflet@1.7.1/dist/images/marker-shadow.png',
      iconSize: [25, 41],
      iconAnchor: [12, 41],
      popupAnchor: [1, -34],
      shadowSize: [41, 41]
    });
    const floodProjectIcon = new L.Icon({
      iconUrl: 'https://cdn.jsdelivr.net/gh/pointhi/leaflet-color-markers@master/img/marker-icon-violet.png',
      shadowUrl: 'https://unpkg.com/leaflet@1.7.1/dist/images/marker-shadow.png',
      iconSize: [25, 41],
      iconAnchor: [12, 41],
      popupAnchor: [1, -34],
      shadowSize: [41, 41]
    });

    // Pejabat JPS marker (blue)
    L.marker([5.39448, 103.06308], {icon: pejabatIcon})
      .addTo(map)
      .bindPopup("Pejabat JPS Kuala Nerus");

    // Flood Siren markers (red)
    [
      { name: "Siren Banjir Tok Jembal", coords: [5.4145, 103.0855] },
      { name: "Siren Banjir Batu Rakit", coords: [5.4630, 103.1020] },
      { name: "Siren Banjir Seberang Takir", coords: [5.3660, 103.0990] }
    ].forEach(point => {
      L.marker(point.coords, {icon: floodSirenIcon})
        .addTo(map)
        .bindPopup(point.name);
    });

    // Rainfall Stations (green)
    [
      { name: "Stesen Hujan Gong Badak", coords: [5.3950, 103.0850] },
      { name: "Stesen Hujan Batu Rakit", coords: [5.4600, 103.1000] }
    ].forEach(point => {
      L.marker(point.coords, {icon: rainStationIcon})
        .addTo(map)
        .bindPopup(point.name);
    });

    // River Level Stations (yellow)
    [
      { name: "Stesen Aras Air Sungai Nerus", coords: [5.4000, 103.0700] }
    ].forEach(point => {
      L.marker(point.coords, {icon: riverLevelIcon})
        .addTo(map)
        .bindPopup(point.name);
    });

    // Flood Mitigation Project (violet)
    [
      { name: "Projek Tebatan Banjir UMT", coords: [5.40788, 103.0886] }
    ].forEach(point => {
      L.marker(point.coords, {icon: floodProjectIcon})
        .addTo(map)
        .bindPopup(point.name);
    });

    // Ensure legend stays on map
    const legend = document.getElementById('map-legend');
    if (legend) {
      map.getContainer().appendChild(legend);
    }

    mapInitialized = true;
  }

  if (toggleMapBtn && mapContainer) {
    initMap();
    toggleMapBtn.addEventListener("click", () => {
      const isHidden = mapContainer.style.display === "none";
      mapContainer.style.display = isHidden ? "block" : "none";
      toggleMapBtn.textContent = isHidden ? "Sembunyikan Peta" : "Lihat Peta";
      if (!isHidden && map) setTimeout(() => map.invalidateSize(), 200);
    });
  }

  // --- Hydrology Cluster Markers ---
  // Only run after map is initialized
  function addHydroClusters() {
    if (!window.map || typeof L === "undefined") return;

    // Example dynamic river/rainfall data for markers
    const hydroStations = [
      {
        name: "Stesen Aras Air Sungai Nerus",
        coords: [5.4000, 103.0700],
        river_level: 1.8,
        river_status: "Normal",
        rainfall: 14.2,
        last_update: "2025-06-18 15:00"
      },
      {
        name: "Stesen Aras Air Sungai Tepoh",
        coords: [5.4200, 103.0800],
        river_level: 2.5,
        river_status: "Amaran",
        rainfall: 9.7,
        last_update: "2025-06-18 14:45"
      },
      {
        name: "Stesen Aras Air Sungai Batu Rakit",
        coords: [5.4600, 103.1000],
        river_level: 3.1,
        river_status: "Bahaya",
        rainfall: 11.5,
        last_update: "2025-06-18 14:30"
      }
    ];

    // Color-coded icon URLs
    const hydroIcons = {
      "Normal": new L.Icon({
        iconUrl: 'https://cdn.jsdelivr.net/gh/pointhi/leaflet-color-markers@master/img/marker-icon-green.png',
        shadowUrl: 'https://unpkg.com/leaflet@1.7.1/dist/images/marker-shadow.png',
        iconSize: [25, 41],
        iconAnchor: [12, 41],
        popupAnchor: [1, -34],
        shadowSize: [41, 41]
      }),
      "Amaran": new L.Icon({
        iconUrl: 'https://cdn.jsdelivr.net/gh/pointhi/leaflet-color-markers@master/img/marker-icon-yellow.png',
        shadowUrl: 'https://unpkg.com/leaflet@1.7.1/dist/images/marker-shadow.png',
        iconSize: [25, 41],
        iconAnchor: [12, 41],
        popupAnchor: [1, -34],
        shadowSize: [41, 41]
      }),
      "Bahaya": new L.Icon({
        iconUrl: 'https://cdn.jsdelivr.net/gh/pointhi/leaflet-color-markers@master/img/marker-icon-red.png',
        shadowUrl: 'https://unpkg.com/leaflet@1.7.1/dist/images/marker-shadow.png',
        iconSize: [25, 41],
        iconAnchor: [12, 41],
        popupAnchor: [1, -34],
        shadowSize: [41, 41]
      })
    };

    // Remove previous hydrology markers if any
    if (window.hydroClusterGroup) {
      window.map.removeLayer(window.hydroClusterGroup);
    }

    // Create cluster group
    const hydroClusterGroup = L.markerClusterGroup();

    hydroStations.forEach(station => {
      const icon = hydroIcons[station.river_status] || hydroIcons["Normal"];
      let statusColor = "#155724", statusBg = "#d4edda", statusIcon = "ğŸŸ¢";
      if (station.river_status === "Amaran") { statusColor = "#856404"; statusBg = "#fff3cd"; statusIcon = "ğŸŸ¡"; }
      if (station.river_status === "Bahaya") { statusColor = "#721c24"; statusBg = "#f8d7da"; statusIcon = "ğŸ”´"; }
      const popupHtml = `
        <div style="font-size:1.05em;font-weight:bold;color:#004d99;margin-bottom:0.3em;">${station.name}</div>
        <div style="margin-bottom:0.2em;">
          <span style="font-weight:500;">Paras Air:</span>
          <span style="background:${statusBg};color:${statusColor};padding:2px 10px;border-radius:12px;font-weight:bold;margin-left:4px;">
            ${statusIcon} ${station.river_level} m (${station.river_status})
          </span>
        </div>
        <div style="margin-bottom:0.2em;">
          <span style="font-weight:500;">Hujan:</span>
          <span style="color:#0073e6;font-weight:bold;">${station.rainfall} mm</span>
        </div>
        <div style="font-size:0.97em;color:#888;">
          <span>Kemaskini: <b>${station.last_update}</b></span>
        </div>
      `;
      marker = L.marker(station.coords, { icon });
      marker.bindPopup(popupHtml);
      hydroClusterGroup.addLayer(marker);
    });

    window.map.addLayer(hydroClusterGroup);
    window.hydroClusterGroup = hydroClusterGroup;
  }

  // Wait a moment after map is initialized, then add clusters
  setTimeout(addHydroClusters, 500);
});
</script>

<!-- Rainfall JSON Data (place in your HTML, e.g. before your rainfall section) -->
<script id="rainfall-json" type="application/json">
[
  {
    "station": "Gong Badak",
    "rainfall": 14.2,
    "updated": "2025-06-18 15:00"
  },
  {
    "station": "Batu Rakit",
    "rainfall": 9.7,
    "updated": "2025-06-18 14:45"
  },
  {
    "station": "Seberang Takir",
    "rainfall": 11.5,
    "updated": "2025-06-18 14:30"
  },
  {
    "station": "Tok Jembal",
    "rainfall": 7.8,
    "updated": "2025-06-18 14:20"
  },
  {
    "station": "Kampung Pak Tuyu",
    "rainfall": 6.3,
    "updated": "2025-06-18 14:10"
  }
]
</script>

<!-- Rainfall Data Section with Download as CSV -->
<section id="hydrology-data" class="section">
  <h2>ğŸŒ§ï¸ Taburan Hujan Kuala Nerus</h2>
  <button id="toggleView" class="map-toggle-btn">Tukar kepada Carta ğŸ“ˆ</button>
  <button id="downloadRainfallCSV" class="map-toggle-btn" style="margin-left:10px;">Muat Turun CSV</button>
  <div class="responsive-table">
    <table id="rainfallTable">
      <thead>
        <tr>
          <th>Stesen</th>
          <th>Jumlah Hujan (mm)</th>
          <th>Kemaskini</th>
        </tr>
      </thead>
      <tbody id="rainfallTableBody">
        <!-- Data will be inserted here -->
      </tbody>
    </table>
  </div>
  <div id="rainfall-chart-view" style="display:none;">
    <canvas id="rainChart" height="300"></canvas>
  </div>
</section>

<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
<script>
document.addEventListener("DOMContentLoaded", function () {
  // Get rainfall data from JSON in HTML
  function getRainfallDataFromHTML() {
    const json = document.getElementById('rainfall-json').textContent;
    return JSON.parse(json);
  }

  function updateRainfallTable(data) {
    const tbody = document.getElementById("rainfallTableBody");
    tbody.innerHTML = "";
    data.forEach(row => {
      tbody.innerHTML += `<tr>
        <td>${row.station}</td>
        <td>${row.rainfall}</td>
        <td>${row.updated}</td>
      </tr>`;
    });
  }

  let rainChart = null;
  function showRainChart(data) {
    const ctx = document.getElementById('rainChart').getContext('2d');
    if (rainChart) rainChart.destroy();
    rainChart = new Chart(ctx, {
      type: 'bar',
      data: {
        labels: data.map(d => d.station),
        datasets: [{
          label: 'Jumlah Hujan (mm)',
          data: data.map(d => d.rainfall),
          backgroundColor: ['#0073e6', '#28a745', '#ffc107', '#ff6384', '#36a2eb']
        }]
      },
      options: {
        responsive: true,
        plugins: {
          legend: { display: false },
          title: {
            display: true,
            text: 'Taburan Hujan Terkini Kuala Nerus'
          }
        },
        scales: {
          y: {
            beginAtZero: true,
            title: { display: true, text: 'Hujan (mm)' }
          }
        }
      }
    });
  }

  // Toggle Table/Chart View
  const toggleBtn = document.getElementById("toggleView");
  const chartView = document.getElementById("rainfall-chart-view");
  const tableView = document.querySelector(".responsive-table");

  function refreshRainfallSection() {
    const data = getRainfallDataFromHTML();
    updateRainfallTable(data);
    if (chartView.style.display !== "none") showRainChart(data);
  }

  // Initial load
  refreshRainfallSection();

  // Toggle event
  toggleBtn.addEventListener("click", () => {
    const isTableVisible = tableView.style.display !== "none";
    tableView.style.display = isTableVisible ? "none" : "block";
    chartView.style.display = isTableVisible ? "block" : "none";
    if (!isTableVisible) showRainChart(getRainfallDataFromHTML());
  });

  // Download as CSV
  document.getElementById("downloadRainfallCSV").addEventListener("click", function () {
    const data = getRainfallDataFromHTML();
    let csv = "Stesen,Jumlah Hujan (mm),Kemaskini\n";
    data.forEach(row => {
      csv += `"${row.station}","${row.rainfall}","${row.updated}"\n`;
    });
    const blob = new Blob([csv], { type: "text/csv" });
    const url = URL.createObjectURL(blob);
    const a = document.createElement("a");
    a.href = url;
    a.download = "rainfall_kuala_nerus.csv";
    document.body.appendChild(a);
    a.click();
    document.body.removeChild(a);
    URL.revokeObjectURL(url);
  });

  // Optional: Auto-refresh every 5 minutes (if you update the JSON via backend)
  // setInterval(refreshRainfallSection, 300000);
});
</script>

<!-- Enhanced River Level Section (UI/UX & Mobile Friendly) -->
<section id="river-level" class="section">
  <h2 style="display:flex;align-items:center;gap:0.5rem;">
    <span style="font-size:1.5em;">ğŸŒŠ</span> Aras Air Sungai â€“ Kuala Nerus
    <button id="downloadRiverCSV" class="map-toggle-btn" style="margin-left:10px;">Muat Turun CSV</button>
  </h2>
  <div class="responsive-table">
    <table id="riverLevelTable" style="width:100%;border-collapse:collapse;">
      <thead>
        <tr>
          <th>Stesen</th>
          <th>Paras Air (m)</th>
          <th>Status</th>
          <th>Kemaskini</th>
        </tr>
      </thead>
      <tbody>
        <!-- Filled by JS -->
      </tbody>
    </table>
  </div>
  <div id="river-legend" style="margin-top:1rem;font-size:0.97em;">
    <strong>Legenda Status:</strong>
    <span style="background:#d4edda;color:#155724;padding:2px 10px;border-radius:12px;margin-right:8px;display:inline-block;">ğŸŸ¢ Normal</span>
    <span style="background:#fff3cd;color:#856404;padding:2px 10px;border-radius:12px;margin-right:8px;display:inline-block;">ğŸŸ¡ Amaran</span>
    <span style="background:#f8d7da;color:#721c24;padding:2px 10px;border-radius:12px;display:inline-block;">ğŸ”´ Bahaya</span>
  </div>
</section>

    <section id="repositori-dokumen" class="section">
      <h2>ğŸ“‚ Repositori Dokumen</h2>
      <p>Muat turun borang rasmi, panduan teknikal, dan dokumen tender terkini daripada JPS Kuala Nerus.</p>
      <div class="grid">
        <article>
          <h3>ğŸ“„ Borang Permohonan</h3>
          <ul>
            <li><a href="documents/permit-sungai.pdf" download>Permohonan Rezab Sungai</a></li>
            <li><a href="documents/water-extraction.pdf" download>Permohonan Pengekstrakan Air</a></li>
          </ul>
        </article>
        <article>
          <h3>ğŸ“˜ Panduan Banjir</h3>
          <ul>
            <li><a href="documents/flood-safety.pdf" download>Panduan Pengurusan Banjir</a></li>
            <li><a href="documents/emergency-plan.pdf" download>Pelan Kecemasan</a></li>
          </ul>
        </article>
        <article>
          <h3>ğŸ“‹ Dokumen Tender</h3>
          <ul>
            <li><a href="documents/tender-guidelines.pdf" download>Garis Panduan Tender</a></li>
            <li><a href="documents/bid-requirements.pdf" download>Keperluan Bidaan</a></li>
          </ul>
        </article>
      </div>
    </section>

        <section id="contact" class="section">
      <h2>Hubungi Kami</h2>
      <div class="grid" style="gap: 2rem; margin-top:2rem;">
        <!-- Borang Aduan -->
      <section id="borang-aduan" style="margin-bottom:2rem;">
        <h3>ğŸ“ Borang Aduan</h3>
          <!-- Replace your current Google Form iframe with this responsive wrapper -->
        <div class="responsive-form-iframe">
          <iframe src="https://docs.google.com/forms/d/e/1FAIpQLScHNlMObZewD-NCIHjfqWOCIQdHMnFT2PPR3yr07rG9bLxP9Q/viewform?embedded=true" allowfullscreen>Memuatkanâ€¦</iframe>
        </div>
      </section>

      <!-- Borang Maklum Balas -->
      <section id="borang-maklum-balas" style="margin-bottom:2rem;">
        <h3>ğŸ’¬ Borang Maklum Balas</h3>
          <!-- For Borang Maklum Balas -->
        <div class="responsive-form-iframe">
          <iframe src="https://docs.google.com/forms/d/e/1FAIpQLScOg2tc-4SLojMGjwKtnZxazyVi4At98-2A1B13EdXc0oIebw/viewform?embedded=true" allowfullscreen>Memuatkanâ€¦</iframe>
        </div>
      </section>
      </div>
    </section>
<!-- Place this before your closing </body> tag, ideally above <footer> -->
<div style="width:100%;display:flex;justify-content:center;margin:2rem 0;">
    <div class="fb-page"
      data-href="https://www.facebook.com/jabatanpengairandansaliranterengganu" 
      data-tabs="timeline"
      data-width="340"
      data-height="400"
      data-small-header="false"
      data-adapt-container-width="true"
      data-hide-cover="false"
      data-show-facepile="true">
      <blockquote cite="https://www.facebook.com/jabatanpengairandansaliranterengganu" class="fb-xfbml-parse-ignore">
        <a href="https://www.facebook.com/jabatanpengairandansaliranterengganu">Jabatan Pengairan dan Saliran Terengganu</a>
      </blockquote>
    </div>

<footer>
  <div class="footer-main" style="width:100%;margin:0;padding:2.5rem 0 1.2rem 0;background:#004d99;">
    <div class="footer-grid" style="display:flex;flex-wrap:wrap;gap:2rem;justify-content:space-between;align-items:flex-start;padding:0 4vw;">
      <!-- JPS Info -->
      <div class="footer-col" style="flex:1 1 220px;min-width:200px;text-align:left;">
        <div style="display:flex;align-items:center;gap:0.7rem;">
          <img src="jpslogo.png" alt="Logo JPS" style="height:38px;width:auto;border-radius:6px;box-shadow:0 2px 8px rgba(0,0,0,0.08);background:#fff;">
          <span style="font-size:1.15em;font-weight:700;letter-spacing:0.5px;color:#ffd700;">JPS Daerah Kuala Nerus</span>
        </div>
        <div style="margin-top:0.7em;font-size:0.97em;color:#fff;">
          Kompleks Pentadbiran Bandar Al Wathiqu Billah<br>
          21300 Kuala Nerus, Terengganu
        </div>
      </div>
      <!-- Contact -->
      <div class="footer-col" style="flex:1 1 220px;min-width:200px;">
        <div style="font-weight:700;font-size:1.08em;margin-bottom:0.5em;color:#ffd700;">Hubungi Kami</div>
        <div style="font-size:0.97em;color:#fff;">
          ğŸ“ <a href="tel:+6096653010" style="color:#ffd700;">+60 9-665 3010</a><br>
          ğŸ“± <a href="https://wa.me/60123456789" target="_blank" style="color:#ffd700;">+60 12-345 6789</a><br>
          ğŸ“§ <a href="mailto:jpskualanerus@terengganu.gov.my" style="color:#ffd700;">jpskualanerus@terengganu.gov.my</a>
        </div>
        <div style="font-size:0.97em;margin-top:0.7rem;color:#fff;">
          <span style="font-weight:600;">Waktu Operasi:</span><br>
          Isnin - Jumaat: 8:00 AM - 5:00 PM<br>
          Sabtu & Ahad: Tutup
        </div>
      </div>
      <!-- Quick Links & External -->
      <div class="footer-col" style="flex:1 1 220px;min-width:200px;">
        <div style="font-weight:700;font-size:1.08em;margin-bottom:0.5em;color:#ffd700;">Pautan Pantas</div>
        <div style="margin-bottom:0.7em;">
          <a href="#about" style="color:#ffd700;">Tentang</a> &nbsp;|&nbsp;
          <a href="#services" style="color:#ffd700;">Perkhidmatan</a> &nbsp;|&nbsp;
          <a href="#contact" style="color:#ffd700;">Hubungi</a>
        </div>
        <a href="https://jpsweb.terengganu.gov.my/index.php/ms/" target="_blank" rel="noopener"
          style="color:#fff;background:#0073e6;padding:8px 18px;border-radius:22px;text-decoration:none;display:inline-block;font-weight:600;box-shadow:0 2px 8px rgba(0,0,0,0.08);margin-top:0.5em;">
          Portal Rasmi JPS Negeri Terengganu
        </a>
      </div>
    </div>
    <div style="text-align:center;margin-top:2.2rem;">
      <button id="backToTop" title="Kembali ke atas"
        style="background:#0073e6;color:#fff;border:none;padding:0.7rem 1rem;border-radius:50%;font-size:1.3rem;box-shadow:0 4px 12px rgba(0,0,0,0.10);cursor:pointer;margin:0 0.5rem;">â†‘</button>
      <button id="help-button" title="Bantuan"
        style="background:#28a745;color:#fff;padding:0.7rem 1.2rem;border-radius:22px;box-shadow:0 4px 12px rgba(0,0,0,0.10);cursor:pointer;font-weight:600;margin:0 0.5rem;">Bantuan</button>
    </div>
    <hr style="margin:2rem 0 1rem 0;border:none;border-top:1px solid #0073e6;">
    <div style="font-size:0.98em;color:#e0e0e0;text-align:center;">
      &copy; 2025 Jabatan Pengairan dan Saliran Daerah Kuala Nerus. Hak cipta terpelihara.<br>
      <span style="font-size:0.95em;">Sebarang pertanyaan, sila <a href="#contact" style="color:#ffd700;">hubungi kami</a>.</span>
    </div>
  </div>
</footer>

<!-- Facebook SDK (only include once per page, before </body>) -->
<div id="fb-root"></div>
<script async defer crossorigin="anonymous" 
  src="https://connect.facebook.net/ms_MY/sdk.js#xfbml=1&version=v19.0" nonce="fb"></script>
  <script src="https://unpkg.com/leaflet/dist/leaflet.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
  <script src="https://unpkg.com/leaflet.markercluster/dist/leaflet.markercluster.js"></script>

  <script>
  // Live Date/Time Display and Header Buttons/Search
  document.addEventListener("DOMContentLoaded", function () {
    function updateClock() {
      const now = new Date();
      const days = ["Ahad","Isnin","Selasa","Rabu","Khamis","Jumaat","Sabtu"];
      const months = ["Januari","Februari","Mac","April","Mei","Jun","Julai","Ogos","September","Oktober","November","Disember"];
      const day = days[now.getDay()];
      const date = now.getDate();
      const month = months[now.getMonth()];
      const year = now.getFullYear();
      const time = now.toLocaleTimeString('ms-MY', { hour: '2-digit', minute: '2-digit', second: '2-digit' });
      document.getElementById("date-time-text").textContent =
        `${day}, ${date} ${month} ${year} | ${time}`;
    }
    updateClock();
    setInterval(updateClock, 1000);

   
    // FAQ button
    document.getElementById("faq-btn").onclick = function() {
      window.location.href = "#faq";
    };
    // Contact button   
    document.getElementById("contact-btn").onclick = function() {
      window.location.href = "#contact";
    };
    // Feedback button
    document.getElementById("feedback-btn").onclick = function() {
      window.location.href = "#borang-maklum-balas";
    };

    // Simple HTML search (finds and scrolls to first match)
    document.getElementById("header-search-form").onsubmit = function(e) {
      e.preventDefault();
      const q = document.getElementById("header-search-input").value.trim().toLowerCase();
      if (!q) return;
      // Search all text nodes in body
      let found = false;
      function walk(node) {
        if (found) return;
        if (node.nodeType === 3 && node.textContent.toLowerCase().includes(q)) {
          node.parentElement.scrollIntoView({ behavior: "smooth", block: "center" });
          node.parentElement.style.background = "#fff3cd";
          setTimeout(() => node.parentElement.style.background = "", 2000);
          found = true;
        } else if (node.nodeType === 1 && node.childNodes) {
          node.childNodes.forEach(walk);
        }
      }
      walk(document.body);
      if (!found) alert("Tiada padanan dijumpai.");
    };
  });

  </script>
  <!-- ...other scripts for map, rainfall, river-level, etc. ... -->
   <!-- Rainfall Table & Dashboard -->
<script>
document.addEventListener("DOMContentLoaded", function () {
  function getRainfallDataFromHTML() {
    const json = document.getElementById('rainfall-json').textContent;
    return JSON.parse(json);
  }
  function updateRainfallTable(data) {
    const tbody = document.getElementById("rainfallTableBody");
    tbody.innerHTML = "";
    data.forEach(row => {
      tbody.innerHTML += `<tr>
        <td>${row.station}</td>
        <td>${row.rainfall}</td>
        <td>${row.updated}</td>
      </tr>`;
    });
  }
  // Initial load
  const rainfallData = getRainfallDataFromHTML();
  updateRainfallTable(rainfallData);
  // Download as CSV
  document.getElementById("downloadRainfallCSV").addEventListener("click", function () {
    const data = getRainfallDataFromHTML();
    let csv = "Stesen,Jumlah Hujan (mm),Kemaskini\n";
    data.forEach(row => {
      csv += `"${row.station}","${row.rainfall}","${row.updated}"\n`;
    });
    const blob = new Blob([csv], { type: "text/csv" });
    const url = URL.createObjectURL(blob);
    const a = document.createElement("a");
    a.href = url;
    a.download = "rainfall_kuala_nerus.csv";
    document.body.appendChild(a);
    a.click();
    document.body.removeChild(a);
    URL.revokeObjectURL(url);
  });
});
</script>

<!-- River Level Table & Dashboard -->
<script>
document.addEventListener("DOMContentLoaded", function () {
  const riverData = [
    { station: "Sungai Nerus", level: 1.8, status: "Normal", updated: "2025-06-18 15:00" },
    { station: "Sungai Tepoh", level: 2.5, status: "Amaran", updated: "2025-06-18 14:45" },
    { station: "Sungai Batu Rakit", level: 3.1, status: "Bahaya", updated: "2025-06-18 14:30" }
  ];
  function refreshRiverLevel() {
    const tbody = document.querySelector("#riverLevelTable tbody");
    tbody.innerHTML = "";
    riverData.forEach(d => {
      let color = "#d4edda", fontColor = "#155724", icon = "ğŸŸ¢";
      if (d.status === "Amaran") { color = "#fff3cd"; fontColor = "#856404"; icon = "ğŸŸ¡"; }
      if (d.status === "Bahaya") { color = "#f8d7da"; fontColor = "#721c24"; icon = "ğŸ”´"; }
      tbody.innerHTML += `
        <tr>
          <td data-label="Stesen" style="font-weight:500;">${d.station}</td>
          <td data-label="Paras Air (m)" style="font-weight:500;">${d.level.toFixed(2)}</td>
          <td data-label="Status" style="background:${color};color:${fontColor};font-weight:bold;text-align:center;border-radius:8px;">${icon} ${d.status}</td>
          <td data-label="Kemaskini">${d.updated}</td>
        </tr>`;
    });
  }
  refreshRiverLevel();
  // Download as CSV
  document.getElementById("downloadRiverCSV").addEventListener("click", function () {
    let csv = "Stesen,Paras Air (m),Status,Kemaskini\n";
    riverData.forEach(row => {
      csv += `"${row.station}","${row.level}","${row.status}","${row.updated}"\n`;
    });
    const blob = new Blob([csv], { type: "text/csv" });
    const url = URL.createObjectURL(blob);
    const a = document.createElement("a");
    a.href = url;
    a.download = "aras_air_sungai_kuala_nerus.csv";
    document.body.appendChild(a);
    a.click();
    document.body.removeChild(a);
    URL.revokeObjectURL(url);
  });
  // Back to top button
  const backToTopBtn = document.getElementById("backToTop"); 
  backToTopBtn.addEventListener("click", function () {
    window.scrollTo({ top: 0, behavior: "smooth" });
  });
  // Help button
  const helpButton = document.getElementById("help-button");
  helpButton.addEventListener("click", function () {
    alert("Untuk bantuan, sila hubungi kami melalui pautan Hubungi Kami di footer.");
  });

  document.addEventListener("DOMContentLoaded", function () {
  const navToggle = document.querySelector('.nav-toggle');
  const navMenu = document.querySelector('.nav-menu');
  navToggle.addEventListener('click', function () {
    navMenu.classList.toggle('open');
  });
  navMenu.querySelectorAll('a').forEach(link => {
    link.addEventListener('click', () => {
      if (window.innerWidth < 900) navMenu.classList.remove('open');
    });
  });
});
  
});
</script>
</body>
</html>
